I"”o<hr />
<p>æœ¬æ–‡è®°å½•ä¸€äº›c++çš„ç¬”è®°ï¼Œç¼“æ…¢æ›´æ–°ä¸­ã€‚</p>
<h2 id="ç›®å½•">ç›®å½•</h2>
<h3 id="1-windowsæ•°æ®ç±»å‹-2017-05-08"><a href="#1">1. windowsæ•°æ®ç±»å‹ (2017-05-08)</a></h3>
<h3 id="2-ç›‘è§†æŸä¸ªexeæ˜¯å¦åœ¨è¿è¡Œ-2017-05-01"><a href="#2">2. ç›‘è§†æŸä¸ªexeæ˜¯å¦åœ¨è¿è¡Œ (2017-05-01)</a></h3>
<h3 id="3-å¯åŠ¨å¤–éƒ¨ç¨‹åº-2017-05-08"><a href="#3">3. å¯åŠ¨å¤–éƒ¨ç¨‹åº (2017-05-08)</a></h3>
<h3 id="4-windowsä¸‹çš„ç®€æ˜“socketç¨‹åº-2017-05-24"><a href="#4">4. Windowsä¸‹çš„ç®€æ˜“socketç¨‹åº (2017-05-24)</a></h3>
<h3 id="5-stléƒ¨åˆ†æºç ç¬”è®°time-nan"><a href="#5">5. STLéƒ¨åˆ†æºç ç¬”è®°(TIME NaN)</a></h3>
<h3 id="end-tipstime-nan"><a href="#end">end. Tips(TIME NaN)</a></h3>

<hr />
<h4 id="1">windowsæ•°æ®ç±»å‹</h4>
<p>åœ¨Windowsç¼–ç¨‹/MFCä¸­ï¼Œå¸¸å¸¸é‡è§ä¸€äº›åŸºç¡€ç±»å‹éƒ½æ˜¯å¤§å†™å­—æ¯ï¼Œè€Œä¸”ä¸c/c++ä¸­çš„åŸºç¡€ç±»å‹ä¸ä¸€è‡´çš„æƒ…å†µï¼Œ
å…¶å®è¿™äº›ç±»å‹ä»ç„¶æ˜¯c/c++ä¸­çš„åŸºç¡€ç±»å‹ï¼Œåªæ˜¯å¾®è½¯ä¸ºäº†è§£å†³å…¼å®¹é—®é¢˜ï¼Œè‡ªå·±æ‰€å®šä¹‰çš„ä¸€äº›ç±»å‹ï¼Œä¸‹è¡¨ï¼ˆç§»åŠ¨ç«¯ä¸å¯è§ï¼Œè¯·ä½¿ç”¨PCæµè§ˆå™¨æŸ¥çœ‹ï¼‰ç»™å‡ºäº†windowsä¸­å¸¸è§çš„åŸºç¡€ç±»å‹ã€‚</p>

<table>
  <thead>
    <tr>
      <th>ç±»å‹åç§°</th>
      <th style="text-align: center">å®šä¹‰</th>
      <th>ç±»å‹åç§°</th>
      <th style="text-align: center">å®šä¹‰</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>BOOL</td>
      <td style="text-align: center">typedef int BOOL</td>
      <td>PBOOL</td>
      <td style="text-align: center">typedef BOOL  *PBOOL</td>
    </tr>
    <tr>
      <td>BOOLEAN</td>
      <td style="text-align: center">typedef BYTE BOOLEAN</td>
      <td>PBOOLEAN</td>
      <td style="text-align: center">typedef BOOLEAN *PBOOLEAN</td>
    </tr>
    <tr>
      <td>BYTE</td>
      <td style="text-align: center">typedef unsigned char BYTE</td>
      <td>PBYTE</td>
      <td style="text-align: center">typedef BYTE *PBYTE</td>
    </tr>
    <tr>
      <td>CHAR</td>
      <td style="text-align: center">typedef char CHAR</td>
      <td>PCHAR</td>
      <td style="text-align: center">typedef CHAR *PCHAR</td>
    </tr>
    <tr>
      <td>UCHAR</td>
      <td style="text-align: center">typedef unsigned char UCHAR</td>
      <td>PUCHAR</td>
      <td style="text-align: center">typedef UCHAR *PUCHAR</td>
    </tr>
    <tr>
      <td>SHORT</td>
      <td style="text-align: center">typedef short SHORT</td>
      <td>PSHORT</td>
      <td style="text-align: center">typedef SHORT *PSHORT</td>
    </tr>
    <tr>
      <td>WORD</td>
      <td style="text-align: center">typedef unsigned short WORD</td>
      <td>PUSHORT</td>
      <td style="text-align: center">typedef USHORT *PUSHORT</td>
    </tr>
    <tr>
      <td>DWORD</td>
      <td style="text-align: center">typedef unsigned long DWORD</td>
      <td>PWORD</td>
      <td style="text-align: center">typedef WORD *PWORD</td>
    </tr>
    <tr>
      <td>DWORD32</td>
      <td style="text-align: center">typedef unsigned int DWORD32</td>
      <td>PDWORD</td>
      <td style="text-align: center">typedef DWORD *PDWORD</td>
    </tr>
    <tr>
      <td>DWORD64</td>
      <td style="text-align: center">typedef unsigned _int64 DOWRD64</td>
      <td>PDWORD32</td>
      <td style="text-align: center">typedef DOWORD32 *PDWORD32</td>
    </tr>
    <tr>
      <td>INT</td>
      <td style="text-align: center">typedef int INT</td>
      <td>PDWORD64</td>
      <td style="text-align: center">typedef DWORD64 *PDWORD64</td>
    </tr>
    <tr>
      <td>INT32</td>
      <td style="text-align: center">typedef signed int INT32</td>
      <td>PINT</td>
      <td style="text-align: center">typedef INT *PINT</td>
    </tr>
    <tr>
      <td>INT64</td>
      <td style="text-align: center">typedef signed _int64 INT64</td>
      <td>PINT32</td>
      <td style="text-align: center">typedef INT32 *PNT32</td>
    </tr>
    <tr>
      <td>UINT</td>
      <td style="text-align: center">typedef unsigned int UINT</td>
      <td>PINT64</td>
      <td style="text-align: center">typedef INT64 *PINT64</td>
    </tr>
    <tr>
      <td>UINT32</td>
      <td style="text-align: center">typedef unsigned int UINT32</td>
      <td>PUINT</td>
      <td style="text-align: center">typedef UINT *PUINT</td>
    </tr>
    <tr>
      <td>UINT64</td>
      <td style="text-align: center">typedef unsigned _int64 UINT64</td>
      <td>PUINT32</td>
      <td style="text-align: center">typedef UINT32 *PUINT32</td>
    </tr>
    <tr>
      <td>LONG</td>
      <td style="text-align: center">typedef long LONG</td>
      <td>PUINT64</td>
      <td style="text-align: center">typedef UINT64 *PUINT64</td>
    </tr>
    <tr>
      <td>LONG32</td>
      <td style="text-align: center">typedef signed int LONG32</td>
      <td>PLONG</td>
      <td style="text-align: center">typedef LONG *PLONG</td>
    </tr>
    <tr>
      <td>LONG64</td>
      <td style="text-align: center">typedef _int64 LONG64</td>
      <td>PLONG32</td>
      <td style="text-align: center">typedef LONG32 *PLONG32</td>
    </tr>
    <tr>
      <td>DOWRDLONG</td>
      <td style="text-align: center">typedef ULONGLONG DWORDLONG</td>
      <td>PLONG64</td>
      <td style="text-align: center">typedef LOGN64 *PLONG64</td>
    </tr>
    <tr>
      <td>LONGLONG</td>
      <td style="text-align: center">typedef _int64 LONGLONG</td>
      <td>PDWORDLONG</td>
      <td style="text-align: center">typedef DWORDLONG *PDWORDLONG</td>
    </tr>
    <tr>
      <td>ULONG</td>
      <td style="text-align: center">typedef unsigned long ULONG</td>
      <td>PLONGLONG</td>
      <td style="text-align: center">typedef LONGLONG *PLONGLONG</td>
    </tr>
    <tr>
      <td>ULONG32</td>
      <td style="text-align: center">typedef unsigned int ULONG32</td>
      <td>PULONG</td>
      <td style="text-align: center">typedef ULONG *PULONG</td>
    </tr>
    <tr>
      <td>ULONGLONG</td>
      <td style="text-align: center">typedef unsigned _int64 ULONGLONG</td>
      <td>PULONG32</td>
      <td style="text-align: center">typedef ULONG32 *PULONG32</td>
    </tr>
    <tr>
      <td>ULONG64</td>
      <td style="text-align: center">typedef unsigned _int64 ULONG64</td>
      <td>PULONGLONG</td>
      <td style="text-align: center">typedef ULONGLONG *PULONGLONG</td>
    </tr>
    <tr>
      <td>FLOAT</td>
      <td style="text-align: center">typedef float FLOAT</td>
      <td>PULONG64</td>
      <td style="text-align: center">typedef ULONG64 *PULONG64</td>
    </tr>
    <tr>
      <td>PFLOAT</td>
      <td style="text-align: center">typedef FLOAT *PFLOAT</td>
      <td>LPBOOL</td>
      <td style="text-align: center">typedef BOOL far *LPBOOL</td>
    </tr>
    <tr>
      <td>LPWORD</td>
      <td style="text-align: center">typedef WORD *LPWORD</td>
      <td>LPDWORD</td>
      <td style="text-align: center">typedef DWORD *LPDWORD</td>
    </tr>
    <tr>
      <td>LPINT</td>
      <td style="text-align: center">typedef int *LPINT</td>
      <td>LPLONG</td>
      <td style="text-align: center">typedef long *LPLON</td>
    </tr>
    <tr>
      <td>PWCHAR</td>
      <td style="text-align: center">typedef CHAR *PWCHAR</td>
      <td>PWSTR</td>
      <td style="text-align: center">typedef __nullterminated WCHAR *PSTR</td>
    </tr>
    <tr>
      <td>PCWSTR</td>
      <td style="text-align: center">typedef __nullterminated CONST WCHAR *PCSTR</td>
      <td>LPWSTR</td>
      <td style="text-align: center">typedef __nullterminated WCHAR *LPSTR</td>
    </tr>
  </tbody>
</table>

<p>è¯¥è¡¨æœªåŒ…å«æ‰€æœ‰windowsæ•°æ®ç±»å‹ï¼Œå…·ä½“å¯å‚è€ƒ <a href="http://www.mouseos.com/win64/data_type.html" target="_blank">windowsæ•°æ®ç±»å‹ - mouseOS æŠ€æœ¯å°ç«™ [é“¾æ¥å·²å¤±æ•ˆ]</a></p>

<hr />

<h4 id="2">ç›‘è§†æŸä¸ªexeæ˜¯å¦åœ¨è¿è¡Œ</h4>
<p>åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œå…ˆå¾—å¼„æ¸…æ¥šc++ä¸­æ˜¯å¦æœ‰ä¸€ä¸ªæ•°æ®ç»“æ„æ¥ä¿å­˜ç³»ç»Ÿä¸­è¿è¡Œçš„è¿›ç¨‹ï¼ŒæŸ¥é˜…ç›¸å…³apiçŸ¥åœ¨c++ä¸­æœ‰ä¸€ä¸ªåä¸ºPROCESSENTRE32çš„ç»“æ„ä½“ï¼Œç”¨äºå­˜æ”¾è¿›ç¨‹å¿«ç…§ä¿¡æ¯ï¼Œå…¶ç»“æ„ä½“æºç å¦‚ä¸‹ï¼š</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">tagPROCESSENTRY32</span>
<span class="p">{</span>
    <span class="n">DWORD</span> <span class="n">dwSize</span><span class="p">;</span> <span class="c1">//ç»“æ„å¤§å°</span>
    <span class="n">DWORD</span> <span class="n">cntUsage</span><span class="p">;</span> <span class="c1">//å¼•ç”¨è®¡æ•°ï¼Œå·²å¼ƒç”¨</span>
    <span class="n">DWORD</span> <span class="n">th32ProcessID</span><span class="p">;</span>  <span class="c1">//pid</span>
    <span class="n">ULONG_PTR</span> <span class="n">th32DefaultHeapID</span><span class="p">;</span>  <span class="c1">//é»˜è®¤è¿›ç¨‹å †ï¼Œå·²å¼ƒç”¨</span>
    <span class="n">DWORD</span> <span class="n">th32ModuleID</span><span class="p">;</span> <span class="c1">//è¿›ç¨‹æ¨¡å—ï¼Œå·²å¼ƒç”¨</span>
    <span class="n">DWORD</span> <span class="n">cntThreads</span><span class="p">;</span> <span class="c1">//æ­¤è¿›ç¨‹å¼€å¯çš„è¿›ç¨‹è®¡æ•°å™¨</span>
    <span class="n">DWORD</span> <span class="n">th32ParentProcessID</span><span class="p">;</span>  <span class="c1">//çˆ¶è¿›ç¨‹pid</span>
    <span class="n">LONG</span> <span class="n">pcPriClassBase</span><span class="p">;</span>  <span class="c1">//çº¿ç¨‹ä¼˜å…ˆçº§</span>
    <span class="n">DWORD</span> <span class="n">dwFlags</span><span class="p">;</span>  <span class="c1">//å·²å¼ƒç”¨</span>
    <span class="n">TCHAR</span> <span class="n">szExeFile</span><span class="p">[</span><span class="n">MAX_PATH</span><span class="p">];</span>  <span class="c1">//è¿›ç¨‹å…¨å(\*.exe)</span>
<span class="p">}</span> <span class="n">PROCESSENTRY32</span><span class="p">,</span> <span class="o">*</span><span class="n">PPROCESSENTRY32</span><span class="p">;</span>
</code></pre></div></div>
<p>å¾—çŸ¥è¿™ä¸€ç»“æ„ä½“çš„å­˜åœ¨åï¼Œéœ€è¦æ‰¾åˆ°å¦‚ä½•å»è·å–è¿™æ ·çš„ä¸€ä¸ªç»“æ„ä½“æ•°ç»„æˆ–è€…å…¶ä»–åŒ…å«è¿™ä¸ªç»“æ„ä½“çš„æ•°æ®ç»“æ„ï¼Œåœ¨c++çš„åº“å‡½æ•°ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªCreateToolhelp32Snapshotå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„åŸå‹æ˜¯<code class="language-plaintext highlighter-rouge">HANDLE WINAPI CreateToolhelp32Snapshot(DWORD dwFlags, DWORD th32ProcessID)</code>ï¼Œå¤´æ–‡ä»¶ä¸º<code class="language-plaintext highlighter-rouge">TlHelp32.h</code>,å…¶ä¸­çš„å‚æ•°å«ä¹‰å¦‚ä¸‹ï¼š<br />
dwFlags:æŒ‡å®šå¿«ç…§ä¸­åŒ…å«çš„ç³»ç»Ÿå†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ—æ•°å€¼çš„ä¸€ä¸ªæˆ–å¤šä¸ªï¼š</p>
<blockquote>
  <p>TH32CS_INHERIT - å£°æ˜å¿«ç…§å¥æŸ„æ˜¯å¯ç»§æ‰¿çš„ã€‚   <br />
TH32CS_SNAPALL - åœ¨å¿«ç…§ä¸­åŒ…å«ç³»ç»Ÿä¸­æ‰€æœ‰çš„è¿›ç¨‹å’Œçº¿ç¨‹ã€‚<br />
TH32CS_SNAPHEAPLIST - åœ¨å¿«ç…§ä¸­åŒ…å«åœ¨th32ProcessIDä¸­æŒ‡å®šçš„è¿›ç¨‹çš„æ‰€æœ‰çš„å †ã€‚<br />
TH32CS_SNAPMODULE - åœ¨å¿«ç…§ä¸­åŒ…å«åœ¨th32ProcessIDä¸­æŒ‡å®šçš„è¿›ç¨‹çš„æ‰€æœ‰çš„æ¨¡å—ã€‚<br />
TH32CS_SNAPPROCESS - åœ¨å¿«ç…§ä¸­åŒ…å«ç³»ç»Ÿä¸­æ‰€æœ‰çš„è¿›ç¨‹ã€‚<br />
TH32CS_SNAPTHREAD - åœ¨å¿«ç…§ä¸­åŒ…å«ç³»ç»Ÿä¸­æ‰€æœ‰çš„çº¿ç¨‹ã€‚<br />
Const TH32CS_SNAPHEAPLIST = &amp;H1<br />
Const TH32CS_SNAPPROCESS = &amp;H2<br />
Const TH32CS_SNAPTHREAD = &amp;H4<br />
Const TH32CS_SNAPMODULE = &amp;H8<br />
Const TH32CS_SNAPALL = (TH32CS_SNAPHEAPLIST | TH32CS_SNAPPROCESS | TH32CS_SNAPTHREAD | TH32CS_SNAPMODULE)<br />
Const TH32CS_INHERIT = &amp;H80000000</p>
</blockquote>

<p>th32ProcessID:æŒ‡å®šå°†è¦å¿«ç…§çš„è¿›ç¨‹IDï¼Œå‚æ•°ä¸º0è¡¨ç¤ºå½“å‰è¿›ç¨‹ã€‚æ³¨æ„è¯¥è¿›ç¨‹åªæœ‰åœ¨è®¾ç½®äº†TH32CS_SNAPHEAPLISTæˆ–è€…TH32CS_SNAPMODULEåæ‰ä¼šç”Ÿæ•ˆã€‚
è¿”å›å€¼ä¸ºå¿«ç…§çš„å¥æŸ„ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œè¿”å›<code class="language-plaintext highlighter-rouge">INVALID_HANDLE_VALUE</code>ã€‚</p>

<p>é€šè¿‡æŸ¥é˜…åˆ°è¯¥å‡½æ•°ï¼Œä¾¿å¯ä»¥å¼€å§‹ç¼–å†™ä»£ç å®ç°ç›‘è§†è¿›ç¨‹çš„åŠŸèƒ½äº†ï¼Œè¿™ä¸ªåŠŸèƒ½çš„åŸºæœ¬æ€è·¯æ˜¯éå†ç³»ç»Ÿä¸­ å·²ç»è¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ï¼Œå¦‚æœåœ¨è¯¥åˆ—è¡¨ä¸­èƒ½æ‰¾åˆ°éœ€è¦ç›‘è§†çš„è¿›ç¨‹ï¼Œå°±å¯ä»¥è¯´æ˜è¯¥è¿›ç¨‹åœ¨è¿è¡Œï¼Œåä¹‹åˆ™è¯´æ˜æ²¡æœ‰è¿è¡Œè¯¥exeã€‚</p>

<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">bool</span> <span class="nf">hasProcessRunning</span><span class="p">(</span><span class="n">string</span> <span class="n">exename</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">processMap</span><span class="p">;</span>
  <span class="n">PROCESSENTRY32</span> <span class="n">pe32</span><span class="p">;</span>
  <span class="n">pe32</span><span class="p">.</span><span class="n">dwSize</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">pe32</span><span class="p">);</span>

  <span class="n">HANDLE</span> <span class="n">processSnap</span> <span class="o">=</span> <span class="n">CreateToolhelp32Snapshot</span><span class="p">(</span><span class="n">TH32CS_SNAPPROCESS</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">processSnap</span> <span class="o">==</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span>
  <span class="p">{</span>
     <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"CreateToolhelp32Snapshot Error!"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
     <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">bool</span> <span class="n">result</span> <span class="o">=</span> <span class="n">Process32First</span><span class="p">(</span><span class="n">processSnap</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pe32</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">num</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="k">while</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">string</span> <span class="n">name</span> <span class="o">=</span> <span class="n">pe32</span><span class="p">.</span><span class="n">szExeFile</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">pe32</span><span class="p">.</span><span class="n">th32ProcessID</span><span class="p">;</span>

    <span class="n">processMap</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">id</span><span class="p">));</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">Process32Next</span><span class="p">(</span><span class="n">processSnap</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pe32</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">CloseHandle</span><span class="p">(</span><span class="n">processSnap</span><span class="p">);</span>

  <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">processMap</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
  <span class="k">for</span> <span class="p">(;</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">processMap</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">it</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="o">-&gt;</span><span class="n">first</span> <span class="o">==</span> <span class="n">exename</span><span class="p">)</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>

  <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>æµ‹è¯•ï¼š<br />
é¦–å…ˆç¼–å†™ç®€å•çš„c++ä¸c#æµ‹è¯•ç¨‹åºï¼ˆæˆ–è€…ä½¿ç”¨å…¶ä»–æµ‹è¯•å¯è¿è¡Œæ–‡ä»¶ï¼‰ï¼Œè¯¥ç¨‹åºä¸ºæ§åˆ¶å°ç¨‹åºï¼Œæ•ˆæœä¸ºåœ¨æ§åˆ¶å°è¾“å‡ºä¸€è¡Œâ€œxxx is runningâ€ã€‚
ç„¶åå¼€å¯ç›‘è§†ç¨‹åºï¼Œåˆ†åˆ«ä¼ å…¥æµ‹è¯•ç¨‹åºçš„åç§°ï¼ŒæŸ¥çœ‹è¾“å‡ºç»“æœï¼Œç„¶åå…³é—­æµ‹è¯•ç¨‹åºå†æ¬¡åœ¨ç›‘è§†ç¨‹åºä¸­æŸ¥æ‰¾æµ‹è¯•ç¨‹åºï¼ŒæŸ¥çœ‹è¾“å‡ºç»“æœã€‚</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// CppTest.cpp : Defines the entry point for the console application.</span>
<span class="c1">//</span>
<span class="cp">#include "stdafx.h"
#include &lt;conio.h&gt;
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"CppTest.exe is running..."</span><span class="p">);</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"press any key to exit..."</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">_getch</span><span class="p">())</span>
			<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">CSharpTest</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"CSharpTest.exe is running..."</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"press any key to exit..."</span><span class="p">);</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
<img src="..\assets\img\cpp\running.PNG" alt="" />
<img src="..\assets\img\cpp\close.PNG" alt="" /></p>

<hr />

<h4 id="3">å¯åŠ¨å¤–éƒ¨ç¨‹åº</h4>
<p>åœ¨c++ç¨‹åºä¸­ï¼Œæœ‰æ—¶å€™ä¸€ä¸ªç¨‹åºéœ€è¦å¦å¤–ä¸€ä¸ªç¨‹åºçš„é…åˆæ‰èƒ½æ­£å¸¸å®Œæˆæ“ä½œï¼Œè¿™æ—¶å€™ä¼šæœ‰ä¸€ä¸ªå¯åŠ¨å¤–éƒ¨ç¨‹åºçš„è¿‡ç¨‹ã€‚<br />
è¿™ä¸€è¿‡ç¨‹çš„å®ç°å¹¶ä¸å¤æ‚ï¼Œåœ¨win32APIä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªå‡½æ•°å¯ä»¥å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œå®ƒå°±æ˜¯<code class="language-plaintext highlighter-rouge">CreateProcess</code>ï¼Œè¯¥å‡½æ•°çš„å¤´æ–‡ä»¶ä¸º<code class="language-plaintext highlighter-rouge">windows.h</code>ï¼Œå‡½æ•°åŸå‹è¾ƒä¸ºå¤æ‚ï¼Œå¦‚ä¸‹ï¼š</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">BOOL</span> <span class="nf">CreateProcess</span>
<span class="p">(</span>
<span class="n">LPCTSTR</span> <span class="n">lpApplicationName</span><span class="p">,</span>
<span class="n">LPTSTR</span> <span class="n">lpCommandLine</span><span class="p">,</span>
<span class="n">LPSECURITY_ATTRIBUTES</span> <span class="n">lpProcessAttributes</span><span class="p">,</span>
<span class="n">LPSECURITY_ATTRIBUTES</span> <span class="n">lpThreadAttributes</span><span class="p">,</span>
<span class="n">BOOL</span> <span class="n">bInheritHandles</span><span class="p">,</span>
<span class="n">DWORD</span> <span class="n">dwCreationFlags</span><span class="p">,</span>
<span class="n">LPVOID</span> <span class="n">lpEnvironment</span><span class="p">,</span>
<span class="n">LPCTSTR</span> <span class="n">lpCurrentDirectory</span><span class="p">,</span>
<span class="n">LPSTARTUPINFO</span> <span class="n">lpStartupInfo</span><span class="p">,</span>
<span class="n">LPPROCESS_INFORMATIONlpProcessInformation</span>
<span class="p">);</span>
</code></pre></div></div>

<p>å…¶ä¸­å„ä¸ªå‚æ•°å«ä¹‰å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lpApplicationName  
æŒ‡å‘ä¸€ä¸ªNULLç»“å°¾çš„ã€ç”¨æ¥æŒ‡å®šå¯æ‰§è¡Œæ¨¡å—çš„å­—ç¬¦ä¸²ã€‚  
è¿™ä¸ªå­—ç¬¦ä¸²å¯ä»¥æ˜¯å¯æ‰§è¡Œæ¨¡å—çš„ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œåœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œå‡½æ•°ä½¿ç”¨å½“å‰é©±åŠ¨å™¨å’Œç›®å½•å»ºç«‹å¯æ‰§è¡Œæ¨¡å—çš„è·¯å¾„ã€‚  
è¿™ä¸ªå‚æ•°å¯ä»¥è¢«è®¾ä¸ºNULLï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯æ‰§è¡Œæ¨¡å—çš„åå­—å¿…é¡»å¤„äº lpCommandLine å‚æ•°æœ€å‰é¢å¹¶ç”±ç©ºæ ¼ç¬¦ä¸åé¢çš„å­—ç¬¦åˆ†å¼€ã€‚  

lpCommandLine  
æŒ‡å‘ä¸€ä¸ªä»¥NULLç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²æŒ‡å®šè¦æ‰§è¡Œçš„å‘½ä»¤è¡Œã€‚  
è¿™ä¸ªå‚æ•°å¯ä»¥ä¸ºç©ºï¼Œé‚£ä¹ˆå‡½æ•°å°†ä½¿ç”¨lpApplicationNameå‚æ•°æŒ‡å®šçš„å­—ç¬¦ä¸²å½“åšè¦è¿è¡Œçš„ç¨‹åºçš„å‘½ä»¤è¡Œã€‚  
å¦‚æœlpApplicationNameå’ŒlpCommandLineå‚æ•°éƒ½ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆlpApplicationNameå‚æ•°æŒ‡å®šå°†è¦è¢«è¿è¡Œçš„æ¨¡å—ï¼ŒlpCommandLineå‚æ•°æŒ‡å®šå°†è¢«è¿è¡Œçš„æ¨¡å—çš„å‘½ä»¤è¡Œã€‚æ–°è¿è¡Œçš„è¿›ç¨‹å¯ä»¥ä½¿ç”¨GetCommandLineå‡½æ•°è·å¾—æ•´ä¸ªå‘½ä»¤è¡Œã€‚Cè¯­è¨€ç¨‹åºå¯ä»¥ä½¿ç”¨argcå’Œargvå‚æ•°ã€‚  

lpProcessAttributes  
æŒ‡å‘ä¸€ä¸ªSECURITY_ATTRIBUTESç»“æ„ä½“ï¼Œè¿™ä¸ªç»“æ„ä½“å†³å®šæ˜¯å¦è¿”å›çš„å¥æŸ„å¯ä»¥è¢«å­è¿›ç¨‹ç»§æ‰¿ã€‚å¦‚æœlpProcessAttributeså‚æ•°ä¸ºç©ºï¼ˆNULLï¼‰ï¼Œé‚£ä¹ˆå¥æŸ„ä¸èƒ½è¢«ç»§æ‰¿ã€‚  
åœ¨Windows NTä¸­ï¼šSECURITY_ATTRIBUTESç»“æ„çš„lpSecurityDescriptoræˆå‘˜æŒ‡å®šäº†æ–°è¿›ç¨‹çš„å®‰å…¨æè¿°ç¬¦ï¼Œå¦‚æœå‚æ•°ä¸ºç©ºï¼Œæ–°è¿›ç¨‹ä½¿ç”¨é»˜è®¤çš„å®‰å…¨æè¿°ç¬¦ã€‚  

lpThreadAttributes  
åŒlpProcessAttribute,ä¸è¿‡è¿™ä¸ªå‚æ•°å†³å®šçš„æ˜¯çº¿ç¨‹æ˜¯å¦è¢«ç»§æ‰¿.é€šå¸¸ç½®ä¸ºNULL.  
bInheritHandles
æŒ‡ç¤ºæ–°è¿›ç¨‹æ˜¯å¦ä»è°ƒç”¨è¿›ç¨‹å¤„ç»§æ‰¿äº†å¥æŸ„ã€‚  
å¦‚æœå‚æ•°çš„å€¼ä¸ºçœŸï¼Œè°ƒç”¨è¿›ç¨‹ä¸­çš„æ¯ä¸€ä¸ªå¯ç»§æ‰¿çš„æ‰“å¼€å¥æŸ„éƒ½å°†è¢«å­è¿›ç¨‹ç»§æ‰¿ã€‚è¢«ç»§æ‰¿çš„å¥æŸ„ä¸åŸè¿›ç¨‹æ‹¥æœ‰å®Œå…¨ç›¸åŒçš„å€¼å’Œè®¿é—®æƒé™ã€‚  

dwCreationFlags  
æŒ‡å®šé™„åŠ çš„ã€ç”¨æ¥æ§åˆ¶ä¼˜å…ˆç±»å’Œè¿›ç¨‹çš„åˆ›å»ºçš„æ ‡å¿—ã€‚ä»¥ä¸‹çš„åˆ›å»ºæ ‡å¿—å¯ä»¥ä»¥é™¤ä¸‹é¢åˆ—å‡ºçš„æ–¹å¼å¤–çš„ä»»ä½•æ–¹å¼ç»„åˆåæŒ‡å®šã€‚  

lpEnvironment  
æŒ‡å‘ä¸€ä¸ªæ–°è¿›ç¨‹çš„ç¯å¢ƒå—ã€‚å¦‚æœæ­¤å‚æ•°ä¸ºç©ºï¼Œæ–°è¿›ç¨‹ä½¿ç”¨è°ƒç”¨è¿›ç¨‹çš„ç¯å¢ƒã€‚  
ä¸€ä¸ªç¯å¢ƒå—å­˜åœ¨äºä¸€ä¸ªç”±ä»¥NULLç»“å°¾çš„å­—ç¬¦ä¸²ç»„æˆçš„å—ä¸­ï¼Œè¿™ä¸ªå—ä¹Ÿæ˜¯ä»¥NULLç»“å°¾çš„ã€‚æ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯name=valueçš„å½¢å¼ã€‚  
å› ä¸ºç›¸ç­‰æ ‡å¿—è¢«å½“åšåˆ†éš”ç¬¦ï¼Œæ‰€ä»¥å®ƒä¸èƒ½è¢«ç¯å¢ƒå˜é‡å½“åšå˜é‡åã€‚  
ä¸å…¶ä½¿ç”¨åº”ç”¨ç¨‹åºæä¾›çš„ç¯å¢ƒå—ï¼Œä¸å¦‚ç›´æ¥æŠŠè¿™ä¸ªå‚æ•°è®¾ä¸ºç©ºï¼Œç³»ç»Ÿé©±åŠ¨å™¨ä¸Šçš„å½“å‰ç›®å½•ä¿¡æ¯ä¸ä¼šè¢«è‡ªåŠ¨ä¼ é€’ç»™æ–°åˆ›å»ºçš„è¿›ç¨‹ã€‚å¯¹äºè¿™ä¸ªæƒ…å†µçš„æ¢è®¨å’Œå¦‚ä½•å¤„ç†ï¼Œè¯·å‚è§æ³¨é‡Šä¸€èŠ‚ã€‚  
ç¯å¢ƒå—å¯ä»¥åŒ…å«Unicodeæˆ–ANSIå­—ç¬¦ã€‚å¦‚æœlpEnvironmentæŒ‡å‘çš„ç¯å¢ƒå—åŒ…å«Unicodeå­—ç¬¦ï¼Œé‚£ä¹ˆdwCreationFlagså­—æ®µçš„CREATE_UNICODE_ENâ…¥RONMENTæ ‡å¿—å°†è¢«è®¾ç½®ã€‚å¦‚æœå—åŒ…å«ANSIå­—ç¬¦ï¼Œè¯¥æ ‡å¿—å°†è¢«æ¸…ç©ºã€‚  
è¯·æ³¨æ„ä¸€ä¸ªANSIç¯å¢ƒå—æ˜¯ç”±ä¸¤ä¸ªé›¶å­—èŠ‚ç»“æŸçš„ï¼šä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²çš„ç»“å°¾ï¼Œå¦ä¸€ä¸ªç”¨æ¥ç»“æŸè¿™ä¸ªå¿«ã€‚ä¸€ä¸ªUnicodeç¯å¢ƒå—æ˜¯ç”±å››ä¸ªé›¶å­—èŠ‚ç»“æŸçš„ï¼šä¸¤ä¸ªä»£è¡¨å­—ç¬¦ä¸²ç»“æŸï¼Œå¦ä¸¤ä¸ªç”¨æ¥ç»“æŸå—ã€‚  

lpCurrentDirectory  
æŒ‡å‘ä¸€ä¸ªä»¥NULLç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ç”¨æ¥æŒ‡å®šå­è¿›ç¨‹çš„å·¥ä½œè·¯å¾„ã€‚è¿™ä¸ªå­—ç¬¦ä¸²å¿…é¡»æ˜¯ä¸€ä¸ªåŒ…å«é©±åŠ¨å™¨åçš„ç»å¯¹è·¯å¾„ã€‚å¦‚æœè¿™ä¸ªå‚æ•°ä¸ºç©ºï¼Œæ–°è¿›ç¨‹å°†ä½¿ç”¨ä¸è°ƒç”¨è¿›ç¨‹ç›¸åŒçš„é©±åŠ¨å™¨å’Œç›®å½•ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯ä¸€ä¸ªéœ€è¦å¯åŠ¨åº”ç”¨ç¨‹åºå¹¶æŒ‡å®šå®ƒä»¬çš„é©±åŠ¨å™¨å’Œå·¥ä½œç›®å½•çš„å¤–å£³ç¨‹åºçš„ä¸»è¦æ¡ä»¶ã€‚  

lpStartupInfo  
æŒ‡å‘ä¸€ä¸ªç”¨äºå†³å®šæ–°è¿›ç¨‹çš„ä¸»çª—ä½“å¦‚ä½•æ˜¾ç¤ºçš„STARTUPINFOç»“æ„ä½“ã€‚  

lpProcessInformation  
æŒ‡å‘ä¸€ä¸ªç”¨æ¥æ¥æ”¶æ–°è¿›ç¨‹çš„è¯†åˆ«ä¿¡æ¯çš„PROCESS_INFORMATIONç»“æ„ä½“ã€‚
</code></pre></div></div>

<p>æµ‹è¯•ï¼š<br />
ä½¿ç”¨è¯¥å‡½æ•°æ‰“å¼€ä¸€ä¸ªå¤–éƒ¨ç¨‹åºï¼Œå‚æ•°ä¸ºè¯¥ç¨‹åºå®Œæ•´è·¯å¾„çš„ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">BOOL</span> <span class="nf">processStart</span><span class="p">(</span><span class="n">string</span> <span class="n">path</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">STARTUPINFO</span> <span class="n">si</span><span class="p">;</span>
  <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">si</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">STARTUPINFO</span><span class="p">));</span>
  <span class="n">si</span><span class="p">.</span><span class="n">cb</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="n">STARTUPINFO</span><span class="p">);</span>
  <span class="n">si</span><span class="p">.</span><span class="n">dwFlags</span><span class="o">=</span><span class="n">STARTF_USESHOWWINDOW</span><span class="p">;</span>
  <span class="n">si</span><span class="p">.</span><span class="n">wShowWindow</span><span class="o">=</span><span class="n">SW_SHOW</span><span class="p">;</span>
  <span class="n">PROCESS_INFORMATION</span> <span class="n">pi</span><span class="p">;</span>

  <span class="k">return</span> <span class="n">CreateProcess</span><span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="n">path</span><span class="p">),</span>
                      <span class="nb">NULL</span><span class="p">,</span>
                      <span class="nb">NULL</span><span class="p">,</span>
                      <span class="nb">NULL</span><span class="p">,</span>
                      <span class="n">FALSE</span><span class="p">,</span>
                      <span class="mi">0</span><span class="p">,</span>
                      <span class="nb">NULL</span><span class="p">,</span>
                      <span class="nb">NULL</span><span class="p">,</span>
                      <span class="o">&amp;</span><span class="n">si</span><span class="p">,</span>
                      <span class="o">&amp;</span><span class="n">pi</span>
                      <span class="p">);</span>
</code></pre></div></div>

<hr />
<h4 id="4">Windowsä¸‹çš„ç®€æ˜“socketç¨‹åº</h4>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ä½¿ç”¨çš„IDEæ˜¯ DevCpp 4.9.2ç‰ˆæœ¬ã€‚</p>
<blockquote>
  <p>æ³¨æ„ï¼šåœ¨Devä¸­ä½¿ç”¨socket APIéœ€è¦åœ¨ â€œProject -&gt; Project Options -&gt; Parameters -&gt; Linkerâ€ä¸­æ·»åŠ ä¸€è¡Œâ€-lwsock32â€ï¼Œç„¶ååœ¨é¢„ç¼–è¯‘è¯­å¥ä¸‹æ–¹æ·»åŠ â€#pragma comment(lib,â€WS2_32â€)â€æ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨socketç›¸å…³APIã€‚</p>
</blockquote>

<p>åœ¨c++ç¨‹åºä¸­å¯¹TCPä¸UDPçš„æ“ä½œå‡ ä¹æ˜¯é€šè¿‡socketæ¥å®Œæˆçš„ã€‚
socketé€šä¿¡æµç¨‹å›¾å¦‚ä¸‹ï¼š<br />
<img src="..\assets\img\cpp\socketflow.gif" alt="" /><br />
å›¾ç‰‡æ¥è‡ªï¼š<a href="http://blog.csdn.net/heyutao007/article/details/6588302" target="_blank">socket çš„é€šä¿¡è¿‡ç¨‹_CSDN</a></p>

<p>Windowsä¸‹çš„Socket APIåœ¨ä½¿ç”¨ä¹‹é—´éœ€è¦é€šè¿‡WSAStartupå‡½æ•°è¿›è¡Œåˆå§‹åŒ–æ¥æŒ‡æ˜WinSocketè§„èŒƒçš„ç‰ˆæœ¬ï¼Œå…¶å‡½æ•°åŸå‹ä¸º</p>
<blockquote>
  <p>int WSAStartup(WORD wVersionRequested, LPWSADATA lpWSAData);</p>
</blockquote>

<p>WSAStartupå‡½æ•°æ‰§è¡ŒæˆåŠŸåï¼Œä¼šå°†ä¸ ws2_32.dll æœ‰å…³çš„ä¿¡æ¯å†™å…¥ WSAData ç»“æ„ä½“å˜é‡ã€‚WSAData çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">WSAData</span> <span class="p">{</span>
    <span class="n">WORD</span>           <span class="n">wVersion</span><span class="p">;</span>  <span class="c1">//ws2_32.dll å»ºè®®æˆ‘ä»¬ä½¿ç”¨çš„ç‰ˆæœ¬å·</span>
    <span class="n">WORD</span>           <span class="n">wHighVersion</span><span class="p">;</span>  <span class="c1">//ws2_32.dll æ”¯æŒçš„æœ€é«˜ç‰ˆæœ¬å·</span>
    <span class="c1">//ä¸€ä¸ªä»¥ null ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œç”¨æ¥è¯´æ˜ ws2_32.dll çš„å®ç°ä»¥åŠå‚å•†ä¿¡æ¯</span>
    <span class="kt">char</span>           <span class="n">szDescription</span><span class="p">[</span><span class="n">WSADESCRIPTION_LEN</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
    <span class="c1">//ä¸€ä¸ªä»¥ null ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œç”¨æ¥è¯´æ˜ ws2_32.dll çš„çŠ¶æ€ä»¥åŠé…ç½®ä¿¡æ¯</span>
    <span class="kt">char</span>           <span class="n">szSystemStatus</span><span class="p">[</span><span class="n">WSASYS_STATUS_LEN</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">iMaxSockets</span><span class="p">;</span>  <span class="c1">//2.0ä»¥åä¸å†ä½¿ç”¨</span>
    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">iMaxUdpDg</span><span class="p">;</span>  <span class="c1">//2.0ä»¥åä¸å†ä½¿ç”¨</span>
    <span class="kt">char</span> <span class="n">FAR</span>       <span class="o">*</span><span class="n">lpVendorInfo</span><span class="p">;</span>  <span class="c1">//2.0ä»¥åä¸å†ä½¿ç”¨</span>
<span class="p">}</span> <span class="n">WSADATA</span><span class="p">,</span> <span class="o">*</span><span class="n">LPWSADATA</span><span class="p">;</span>
</code></pre></div></div>

<p>çŸ¥é“äº†ä»¥ä¸Šå†…å®¹ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„ä»£ç æ¥å¯¹socketç¼–ç¨‹æœ‰æ›´æ·±ä¸€æ­¥çš„äº†è§£ã€‚</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//æœåŠ¡ç«¯ä»£ç </span>
<span class="cp">#include &lt;stdio.h&gt;
#include &lt;winsock2.h&gt;
#pragma comment (lib, "ws2_32.lib")  //åŠ è½½ ws2_32.dll
</span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">//åˆå§‹åŒ– DLL</span>
    <span class="n">WSADATA</span> <span class="n">wsaData</span><span class="p">;</span>
    <span class="n">WSAStartup</span><span class="p">(</span> <span class="n">MAKEWORD</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">wsaData</span><span class="p">);</span>
    <span class="c1">//åˆ›å»ºå¥—æ¥å­—</span>
    <span class="n">SOCKET</span> <span class="n">servSock</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">PF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="n">IPPROTO_TCP</span><span class="p">);</span>
    <span class="c1">//ç»‘å®šå¥—æ¥å­—</span>
    <span class="n">sockaddr_in</span> <span class="n">sockAddr</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sockAddr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">sockAddr</span><span class="p">));</span>  <span class="c1">//æ¯ä¸ªå­—èŠ‚éƒ½ç”¨0å¡«å……</span>
    <span class="n">sockAddr</span><span class="p">.</span><span class="n">sin_family</span> <span class="o">=</span> <span class="n">PF_INET</span><span class="p">;</span>  <span class="c1">//ä½¿ç”¨IPv4åœ°å€</span>
    <span class="n">sockAddr</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">s_addr</span> <span class="o">=</span> <span class="n">inet_addr</span><span class="p">(</span><span class="s">"127.0.0.1"</span><span class="p">);</span>  <span class="c1">//å…·ä½“çš„IPåœ°å€</span>
    <span class="n">sockAddr</span><span class="p">.</span><span class="n">sin_port</span> <span class="o">=</span> <span class="n">htons</span><span class="p">(</span><span class="mi">1234</span><span class="p">);</span>  <span class="c1">//ç«¯å£</span>
    <span class="n">bind</span><span class="p">(</span><span class="n">servSock</span><span class="p">,</span> <span class="p">(</span><span class="n">SOCKADDR</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">sockAddr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SOCKADDR</span><span class="p">));</span>
    <span class="c1">//è¿›å…¥ç›‘å¬çŠ¶æ€</span>
    <span class="n">listen</span><span class="p">(</span><span class="n">servSock</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
    <span class="c1">//æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚</span>
    <span class="n">SOCKADDR</span> <span class="n">clntAddr</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">nSize</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SOCKADDR</span><span class="p">);</span>
    <span class="n">SOCKET</span> <span class="n">clntSock</span> <span class="o">=</span> <span class="n">accept</span><span class="p">(</span><span class="n">servSock</span><span class="p">,</span> <span class="p">(</span><span class="n">SOCKADDR</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">clntAddr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nSize</span><span class="p">);</span>
    <span class="c1">//å‘å®¢æˆ·ç«¯å‘é€æ•°æ®</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="s">"Hello World!"</span><span class="p">;</span>
    <span class="n">send</span><span class="p">(</span><span class="n">clntSock</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="o">+</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="c1">//å…³é—­å¥—æ¥å­—</span>
    <span class="n">closesocket</span><span class="p">(</span><span class="n">clntSock</span><span class="p">);</span>
    <span class="n">closesocket</span><span class="p">(</span><span class="n">servSock</span><span class="p">);</span>
    <span class="c1">//ç»ˆæ­¢ DLL çš„ä½¿ç”¨</span>
    <span class="n">WSACleanup</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å®¢æˆ·ç«¯ä»£ç </span>
<span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;WinSock2.h&gt;
#pragma comment(lib, "ws2_32.lib")  //åŠ è½½ ws2_32.dll
</span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">//åˆå§‹åŒ–DLL</span>
    <span class="n">WSADATA</span> <span class="n">wsaData</span><span class="p">;</span>
    <span class="n">WSAStartup</span><span class="p">(</span><span class="n">MAKEWORD</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">wsaData</span><span class="p">);</span>
    <span class="c1">//åˆ›å»ºå¥—æ¥å­—</span>
    <span class="n">SOCKET</span> <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">PF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="n">IPPROTO_TCP</span><span class="p">);</span>
    <span class="c1">//å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚</span>
    <span class="n">sockaddr_in</span> <span class="n">sockAddr</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sockAddr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">sockAddr</span><span class="p">));</span>  <span class="c1">//æ¯ä¸ªå­—èŠ‚éƒ½ç”¨0å¡«å……</span>
    <span class="n">sockAddr</span><span class="p">.</span><span class="n">sin_family</span> <span class="o">=</span> <span class="n">PF_INET</span><span class="p">;</span>
    <span class="n">sockAddr</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">s_addr</span> <span class="o">=</span> <span class="n">inet_addr</span><span class="p">(</span><span class="s">"127.0.0.1"</span><span class="p">);</span>
    <span class="n">sockAddr</span><span class="p">.</span><span class="n">sin_port</span> <span class="o">=</span> <span class="n">htons</span><span class="p">(</span><span class="mi">1234</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="p">(</span><span class="n">SOCKADDR</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">sockAddr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">SOCKADDR</span><span class="p">));</span>
    <span class="c1">//æ¥æ”¶æœåŠ¡å™¨ä¼ å›çš„æ•°æ®</span>
    <span class="kt">char</span> <span class="n">szBuffer</span><span class="p">[</span><span class="n">MAXBYTE</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
    <span class="n">recv</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">szBuffer</span><span class="p">,</span> <span class="n">MAXBYTE</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="c1">//è¾“å‡ºæ¥æ”¶åˆ°çš„æ•°æ®</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Message form server: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">szBuffer</span><span class="p">);</span>
    <span class="c1">//å…³é—­å¥—æ¥å­—</span>
    <span class="n">closesocket</span><span class="p">(</span><span class="n">sock</span><span class="p">);</span>
    <span class="c1">//ç»ˆæ­¢ä½¿ç”¨ DLL</span>
    <span class="n">WSACleanup</span><span class="p">();</span>
    <span class="n">system</span><span class="p">(</span><span class="s">"pause"</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>å‚è€ƒèµ„æ–™ï¼š<a href="http://c.biancheng.net/cpp/html/3029.html" target="_blank">C/C++ socketç¼–ç¨‹æ•™ç¨‹:1å¤©ç©è½¬socketé€šä¿¡æŠ€æœ¯_Cè¯­è¨€ä¸­æ–‡ç½‘</a></p>

<hr />
<h3 id="5">STLéƒ¨åˆ†æºç ç¬”è®°</h3>

<h4 id="list">list</h4>
<p>æœ¬è´¨ï¼šåŒå‘ç¯çŠ¶é“¾è¡¨</p>

<h4 id="vector">vector</h4>
<p>æœ¬è´¨ï¼šåŠ¨æ€è‡ªåŠ¨æ‰©å……æ•°ç»„</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="k">class</span> <span class="nc">Alloc</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">vector</span>
<span class="p">{</span>
<span class="nl">public:</span>
    <span class="k">typedef</span> <span class="n">T</span> <span class="n">value_type</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">value_type</span><span class="o">*</span> <span class="n">iterator</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">value_type</span><span class="o">&amp;</span> <span class="n">reference</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="kt">size_t</span> <span class="n">size_type</span><span class="p">;</span>
<span class="nl">protected:</span>
    <span class="n">iterator</span> <span class="n">start</span><span class="p">;</span>
    <span class="n">iterator</span> <span class="n">finish</span><span class="p">;</span>
    <span class="n">iterator</span> <span class="n">end_of_storage</span><span class="p">;</span>
<span class="nl">public:</span>
    <span class="n">iterator</span> <span class="n">begin</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">start</span><span class="p">;</span> <span class="p">}</span>
    <span class="n">iterator</span> <span class="n">end</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">finish</span><span class="p">;</span> <span class="p">}</span>
    <span class="n">size_type</span> <span class="n">size</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">size_type</span><span class="p">(</span><span class="n">end</span><span class="p">()</span><span class="o">-</span><span class="n">begin</span><span class="p">());</span> <span class="p">}</span>
    <span class="n">size_type</span> <span class="n">capacity</span><span class="p">()</span> <span class="k">const</span>
    <span class="p">{</span> <span class="k">return</span> <span class="n">size_type</span><span class="p">(</span><span class="n">end_of_storage</span><span class="o">-</span><span class="n">begin</span><span class="p">());</span> <span class="p">}</span>
    <span class="kt">bool</span> <span class="n">empty</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">begin</span><span class="p">()</span> <span class="o">==</span> <span class="n">end</span><span class="p">();</span> <span class="p">}</span>
    <span class="n">reference</span> <span class="k">operator</span><span class="p">[]</span> <span class="p">(</span><span class="n">size_type</span> <span class="n">n</span><span class="p">)</span>
    <span class="p">{</span> <span class="k">return</span> <span class="o">*</span><span class="p">(</span><span class="n">begin</span><span class="p">()</span><span class="o">+</span><span class="n">n</span><span class="p">);</span> <span class="p">}</span>
    <span class="n">reference</span> <span class="n">front</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="o">*</span><span class="n">begin</span><span class="p">();</span> <span class="p">}</span>
    <span class="n">reference</span> <span class="n">back</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="o">*</span><span class="p">(</span><span class="n">end</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<hr />
<h3 id="end">Tips</h3>

<h4 id="guardå¤´æ–‡ä»¶-é˜²å¾¡å¼å£°æ˜">Guardå¤´æ–‡ä»¶ (é˜²å¾¡å¼å£°æ˜)</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#ifndef __HEADERNAME__
#define __HEADERNAME__
</span><span class="p">...</span>
<span class="cp">#endif
</span></code></pre></div></div>
<p>ä½œç”¨ï¼šé˜²æ­¢é‡å¤include</p>

<h4 id="constç”¨æ³•">constç”¨æ³•</h4>
<p>const é™¤äº†è¡¨ç¤ºå¸¸é‡ä¹‹å¤–ï¼Œåœ¨å‡½æ•°ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œconstå‡ºç°åœ¨å‡½æ•°ä¸­æ—¶ï¼Œæœ‰ä¸‰ç§å¯èƒ½çš„ä½ç½®ã€‚</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ç”¨äºä¿®é¥°è¿”å›å€¼çš„æ—¶å€™</span>
<span class="c1">//å¦‚æœè¿”å›å€¼ä¸ºæŒ‡é’ˆå½¢å¼ï¼Œè¯¥è¿”å›å€¼ï¼ˆæŒ‡é’ˆï¼‰ä¸å¯è¢«ä¿®æ”¹ï¼Œä¸”åªèƒ½èµ‹å€¼ç»™constä¿®é¥°çš„åŒç±»å‹æŒ‡é’ˆ</span>
<span class="c1">//è¿”å›å€¼ä¸ºå€¼ç±»å‹ï¼ŒåŠ constä¿®é¥°æ²¡æœ‰ä»»ä½•ä»·å€¼ï¼Œå› ä¸ºå€¼ç±»å‹ä¼ é€’è¿”å›çš„æ—¶å€™ä¼šè¿”å›ä¸€ä¸ªå‰¯æœ¬</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">fun</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">value</span><span class="p">;</span> <span class="p">}</span>

<span class="c1">//ä»¥ä¸‹è¯­å¥éæ³•</span>
<span class="kt">char</span><span class="o">*</span> <span class="n">str</span> <span class="o">=</span> <span class="n">fun</span><span class="p">();</span>
<span class="c1">//ä»¥ä¸‹è¯­å¥åˆæ³•</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">str</span> <span class="o">=</span> <span class="n">fun</span><span class="p">();</span>

<span class="c1">//ä¸ä¼šæ”¹å˜å…¶è¿”å›å€¼çš„æ—¶å€™åŠ ä¸Šconst</span>
<span class="c1">//ç±»æ¯”äºc#ä¸­çš„getå±æ€§</span>
<span class="n">string</span> <span class="n">fun</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">value</span><span class="p">;</span> <span class="p">}</span>

<span class="c1">//å‚æ•°å€¼ä¸å¯åœ¨å‡½æ•°ä½“ä¸­è¢«ä¿®æ”¹</span>
<span class="n">string</span> <span class="nf">fun</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span> <span class="n">value</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span> <span class="k">return</span> <span class="n">value</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div></div>
<p>ç”¨äºä¿®é¥°æŒ‡é’ˆçš„æ—¶å€™ï¼Œä¹Ÿæœ‰ä¸‰ç§æƒ…å†µã€‚</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å·¦å®šå€¼ï¼Œconstå‡ºç°åœ¨*å·¦è¾¹ï¼ŒæŒ‡å‘çš„å€¼ä¸å¯æ”¹å˜</span>
<span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="c1">//å³å®šå‘ï¼Œconstå‡ºç°åœ¨*å³è¾¹</span>
<span class="c1">//å…¶æŒ‡å‘çš„åœ°å€ä¸å¯æ›´æ”¹ï¼Œä½†åœ°å€å†…å€¼å¯ä»¥æ›´æ”¹</span>
<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="kt">int</span><span class="o">*</span> <span class="k">const</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">num</span><span class="p">;</span>
<span class="c1">//æŒ‡å‘çš„åœ°å€ä¸å€¼ä¸å¯æ›´æ”¹</span>
<span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span><span class="o">*</span> <span class="k">const</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="friend---å‹å…ƒ">friend - å‹å…ƒ</h4>
<ul>
  <li>ç±»çš„å‹å…ƒå‡½æ•°æ˜¯å®šä¹‰åœ¨ç±»å¤–éƒ¨ï¼Œä½†æœ‰æƒè®¿é—®ç±»çš„æ‰€æœ‰ç§æœ‰ï¼ˆprivateï¼‰æˆå‘˜å’Œä¿æŠ¤ï¼ˆprotectedï¼‰æˆå‘˜</li>
  <li>å‹å…ƒå‡½æ•°å¹¶ä¸æ˜¯æˆå‘˜å‡½æ•°</li>
  <li><strong>ç›¸åŒclassçš„å„ä¸ªobjectsäº’ä¸ºfriend</strong>ï¼Œæˆ–è€…è¯´ç±»ä¸è‡ªèº«äº’ä¸ºå‹å…ƒç±»</li>
  <li>friend åˆ†ä¸ºå‹å…ƒå‡½æ•°å’Œå‹å…ƒç±»</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">person</span>
<span class="p">{</span>
<span class="nl">private:</span>
    <span class="n">string</span> <span class="n">name</span><span class="p">;</span>
<span class="nl">public:</span>
    <span class="c1">//å‹å…ƒå‡½æ•°</span>
    <span class="k">friend</span> <span class="kt">void</span> <span class="n">print_name</span><span class="p">(</span><span class="k">const</span> <span class="n">person</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">);</span>
    <span class="c1">//å‹å…ƒç±»</span>
    <span class="k">friend</span> <span class="k">class</span> <span class="nc">dog</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">print_name</span><span class="p">(</span><span class="k">const</span> <span class="n">person</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">)</span>
<span class="p">{</span> <span class="n">out</span> <span class="o">&lt;&lt;</span> <span class="s">"name:"</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div></div>

<h4 id="temp-object---ä¸´æ—¶å¯¹è±¡">temp object - ä¸´æ—¶å¯¹è±¡</h4>
<p>ç”¨æ³•ï¼š typename();</p>

<h4 id="operator---æ“ä½œç¬¦é‡è½½">operator - æ“ä½œç¬¦é‡è½½</h4>
<p>ç”¨æ³•ï¼š è¿”å›å€¼ operator æ“ä½œç¬¦ (params) { }<br />
Â«Â æ“ä½œç¬¦ä¸èƒ½ä½œä¸ºæˆå‘˜å‡½æ•°é‡è½½ï¼Œé‡è½½æ ¼å¼ä¸º:</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ä»¥ä¸‹ä»£ç éæ³•</span>
<span class="n">ostream</span> <span class="k">operator</span> <span class="o">&lt;&lt;</span> <span class="k">const</span> <span class="p">(</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">os</span><span class="p">,</span> <span class="k">const</span> <span class="n">person</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">;</span> <span class="p">}</span>
<span class="c1">//ä»¥ä¸‹ä»£ç åˆæ³•</span>
<span class="n">ostream</span><span class="o">&amp;</span> <span class="k">operator</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">os</span><span class="p">,</span> <span class="k">const</span> <span class="n">person</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">name</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div></div>
<p>å¦‚æœè€ƒè™‘è¿ç»­æ€§æ“ä½œç¬¦çš„æƒ…å†µï¼Œæ“ä½œç¬¦é‡è½½è¿”å›å€¼ä¸èƒ½ä¸ºvoidã€‚</p>

<h4 id="æ‹·è´æ„é€ ä¸æ‹·è´èµ‹å€¼æ·±æµ…æ‹·è´">æ‹·è´æ„é€ ä¸æ‹·è´èµ‹å€¼ï¼ˆæ·±æµ…æ‹·è´ï¼‰</h4>
<p>ç±»ä¸­å¦‚æœå¸¦æœ‰æŒ‡é’ˆï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šæ‹·è´æ„é€ å’Œæ‹·è´èµ‹å€¼ã€‚</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//Big three</span>
<span class="k">class</span> <span class="nc">person</span>
<span class="p">{</span>
<span class="nl">public:</span>
<span class="p">{</span>
    <span class="c1">//one</span>
    <span class="n">person</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">);</span>
    <span class="c1">//one - æ‹·è´æ„é€ </span>
    <span class="n">person</span><span class="p">(</span><span class="k">const</span> <span class="n">person</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">);</span>
    <span class="c1">//two - æ‹·è´èµ‹å€¼</span>
    <span class="n">person</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">person</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">);</span>
    <span class="c1">//three - ææ„</span>
    <span class="o">~</span><span class="n">person</span><span class="p">();</span>
<span class="nl">private:</span>
    <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">;</span>
<span class="p">};</span>

<span class="kr">inline</span> <span class="n">person</span><span class="o">&amp;</span> <span class="n">person</span><span class="o">::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">person</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//æ£€æµ‹è‡ªæˆ‘èµ‹å€¼ï¼ˆself assignmentï¼‰</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="o">==</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
    
    <span class="c1">//å…ˆæ¸…ç†åŸå…ˆå†…å­˜</span>
    <span class="k">delete</span><span class="p">[]</span> <span class="n">name</span><span class="p">;</span>
    <span class="c1">//ç”³è¯·æ–°å†…å­˜</span>
    <span class="n">name</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">strlen</span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">name</span><span class="p">)];</span>
    <span class="c1">//æ·±æ‹·è´</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">other</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
    
<span class="p">}</span>
</code></pre></div></div>

<h4 id="struct-å’Œ-class">struct å’Œ class</h4>
<ul>
  <li>å¦‚æœæ²¡æœ‰æ ‡æ˜æˆå‘˜å‡½æ•°æˆ–è€…æˆå‘˜å˜é‡çš„è®¿é—®æƒé™çº§åˆ«ï¼Œstructä¸­é»˜è®¤æ˜¯publicï¼Œclassä¸­é»˜è®¤æ˜¯privateã€‚</li>
  <li>å½“classå’Œstructç›¸äº’ç»§æ‰¿çš„æ—¶å€™ï¼Œæƒé™çº§åˆ«å–å†³äºå­ç±»çš„ç±»å‹ã€‚</li>
</ul>

<h4 id="heap-å’Œ-stack">heap å’Œ stack</h4>
<ul>
  <li>stackæ˜¯å­˜åœ¨äºæŸä½œç”¨åŸŸï¼ˆscopeï¼‰çš„ä¸€å—å†…å­˜ç©ºé—´ï¼Œå‡½æ•°å†…å£°æ˜çš„ä»»ä½•å˜é‡ï¼Œå…¶æ‰€ä½¿ç”¨çš„å†…å­˜å‡å–è‡ªäºstackã€‚</li>
  <li>heapæ˜¯ç”±æ“ä½œç³»ç»Ÿæä¾›çš„ä¸€å—globalå†…å­˜ç©ºé—´ï¼Œç¨‹åºå¯ä»¥é€šè¿‡åŠ¨æ€åˆ†é…ä»ä¸­è·å–ã€‚</li>
</ul>

<h4 id="new-å’Œ-delete">new å’Œ delete</h4>
<ul>
  <li>new: å…ˆåˆ†é…memoryï¼Œå†è°ƒç”¨ctor</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">person</span> <span class="o">*</span><span class="n">stu</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">person</span><span class="p">(</span><span class="s">"Zhang san"</span><span class="p">);</span>

<span class="c1">//ç¼–è¯‘å™¨ä¼˜åŒ–ä»£ç å¦‚ä¸‹ï¼š</span>
<span class="kt">void</span><span class="o">*</span> <span class="n">mem</span> <span class="o">=</span> <span class="k">operator</span> <span class="nf">new</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">person</span><span class="p">));</span>  <span class="c1">//åˆ†é…å†…å­˜</span>
<span class="n">stu</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">person</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">mem</span><span class="p">);</span>            <span class="c1">//ç±»å‹è½¬åŒ–</span>
<span class="n">stu</span><span class="o">-&gt;</span><span class="n">person</span><span class="o">::</span><span class="n">person</span><span class="p">(</span><span class="s">"Zhang san"</span><span class="p">);</span>           <span class="c1">//è°ƒç”¨æ„é€ å‡½æ•°</span>
</code></pre></div></div>

<ul>
  <li>delete: å…ˆè°ƒç”¨dctorï¼Œå†å›æ”¶å†…å­˜</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">delete</span> <span class="n">stu</span><span class="p">;</span>

<span class="c1">//ç¼–è¯‘å™¨ä¼˜åŒ–ä»£ç å¦‚ä¸‹ï¼š</span>
<span class="n">person</span><span class="o">::~</span><span class="n">person</span><span class="p">(</span><span class="n">stu</span><span class="p">);</span>   <span class="c1">//è°ƒç”¨ææ„å‡½æ•°</span>
<span class="k">operator</span> <span class="nf">delete</span><span class="p">(</span><span class="n">stu</span><span class="p">);</span>   <span class="c1">//é‡Šæ”¾å†…å­˜</span>
</code></pre></div></div>

<h4 id="æ³›åŒ–ç‰¹åŒ–åç‰¹åŒ–">æ³›åŒ–ã€ç‰¹åŒ–ã€åç‰¹åŒ–</h4>
<p>STLæºç æ ·ä¾‹</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define __STL_TEMPLATE_NULL template&lt;&gt;
</span>
<span class="c1">//æ³›åŒ–</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Key</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">hash</span> <span class="p">{</span> <span class="p">};</span> 
<span class="c1">//ç‰¹åŒ– (å…¨ç‰¹åŒ–)</span>
<span class="n">__STL_TEMPLATE_NULL</span> <span class="k">struct</span> <span class="nc">hash</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span>
<span class="p">{</span> <span class="kt">size_t</span> <span class="k">operator</span><span class="p">()(</span><span class="kt">char</span> <span class="n">x</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">x</span><span class="p">;</span> <span class="p">}</span> <span class="p">};</span>

<span class="c1">//æ³›åŒ–</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="k">class</span> <span class="nc">Alloc</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">vector</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">};</span>
<span class="c1">//åç‰¹åŒ–</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Alloc</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">,</span> <span class="n">Alloc</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">};</span>

<span class="c1">//æ³›åŒ–</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Iterator</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">iterator_traits</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">};</span>
<span class="c1">//åç‰¹åŒ–ï¼ˆæŒ‡é’ˆï¼‰</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">iterator_traites</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*&gt;</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">};</span>
</code></pre></div></div>

<h4 id="è™šå‡½æ•°---virtual">è™šå‡½æ•° - virtual</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">shape</span>
<span class="p">{</span>
<span class="nl">public:</span>
    <span class="c1">//çº¯è™šå‡½æ•°</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">draw</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="c1">//è™šå‡½æ•°</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">error</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">msg</span><span class="p">);</span>
    <span class="c1">//éè™šå‡½æ•°</span>
    <span class="kt">int</span> <span class="n">object_id</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="æ™ºèƒ½æŒ‡é’ˆ">æ™ºèƒ½æŒ‡é’ˆ</h4>
<p>ä½¿ç”¨classå»æ¨¡æ‹ŸæŒ‡é’ˆçš„æ“ä½œï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªclassï¼Œå´æ‹¥æœ‰æ‰€æœ‰æŒ‡é’ˆçš„æ“ä½œï¼ˆpointer-like objectï¼‰ã€‚</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//é‡è½½++æ—¶ï¼Œå¸¦å‚æ•°çš„ä¸ºi++ï¼Œä¸å¸¦å‚æ•°çš„ä¸º++iï¼Œä½†æ˜¯è¯¥å‚æ•°å¹¶æ— ä½œç”¨ï¼Œä»…ä»…ç”¨äºåŒºåˆ†</span>
<span class="c1">//STLä¸­list_iteratoræºç </span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span> <span class="k">class</span> <span class="nc">Ref</span><span class="p">,</span> <span class="k">class</span> <span class="nc">Ptr</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">__list_iterator</span>
<span class="p">{</span>
    <span class="k">typedef</span> <span class="n">__list_iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">Ref</span><span class="p">,</span> <span class="n">Ptr</span><span class="o">&gt;</span> <span class="n">self</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">bidirection_iterator_tag</span> <span class="n">iterator_category</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">T</span> <span class="n">value_type</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">Ptr</span> <span class="n">pointer</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">Ref</span> <span class="n">reference</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="n">__list_node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;*</span> <span class="n">link_type</span><span class="p">;</span>
    <span class="k">typedef</span> <span class="kt">ptrdiff_t</span> <span class="n">difference_type</span><span class="p">;</span>

    <span class="n">link_type</span> <span class="n">node</span><span class="p">;</span>

    <span class="n">reference</span> <span class="k">operator</span><span class="o">*</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="o">*</span><span class="n">node</span><span class="p">).</span><span class="n">data</span><span class="p">;</span> <span class="p">}</span>
    <span class="n">pointer</span> <span class="k">operator</span><span class="o">-&gt;</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="o">&amp;</span><span class="p">(</span><span class="k">operator</span><span class="o">*</span><span class="p">());</span> <span class="p">}</span>
    <span class="c1">//++iter</span>
    <span class="n">self</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">++</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">node</span> <span class="o">=</span> <span class="p">(</span><span class="n">link_type</span><span class="p">)((</span><span class="o">*</span><span class="n">node</span><span class="p">).</span><span class="n">next</span><span class="p">);</span>
        <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//iter++</span>
    <span class="n">self</span> <span class="k">operator</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//æ­¤å¤„ä¸ä¼šè°ƒç”¨é‡è½½çš„*æ“ä½œ</span>
        <span class="c1">//å› ä¸ºå…ˆé‡åˆ°äº†=æ“ä½œç¬¦ï¼Œä¼šè°ƒç”¨copy ctorç”¨äºåˆ›å»ºtmpå¹¶ä¸”ä»¥*thisä¸ºåˆå€¼</span>
        <span class="c1">//æ•…*thiså°†è¢«è§£é‡Šä¸ºctorçš„å‚æ•°</span>
        <span class="c1">//copy ctor:</span>
        <span class="c1">//__list_iterator(const interator&amp; x) : node(x.node) { }</span>
        <span class="n">self</span> <span class="n">tmp</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
        <span class="o">++*</span><span class="k">this</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">...</span>
<span class="p">};</span>

</code></pre></div></div>
<p>å…¶ä¸­ï¼Œiter++å’Œ++iterçš„è¿”å›å€¼ä¸åŒçš„åŸå› æ˜¯ä¸ºäº†ç¬¦åˆæŒ‡é’ˆçš„å++ä¸å…è®¸è¿ç»­ä¸¤æ¬¡çš„æ“ä½œ</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">list</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">;</span>
<span class="k">auto</span> <span class="n">iter</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
<span class="o">++++</span><span class="n">iter</span><span class="p">;</span> <span class="c1">//åˆæ³•</span>
<span class="n">iter</span><span class="o">++++</span><span class="p">;</span> <span class="c1">//éæ³•</span>
</code></pre></div></div>

<h4 id="4ç§ç±»å‹è½¬æ¢å‡½æ•°">4ç§ç±»å‹è½¬æ¢å‡½æ•°</h4>

<ol>
  <li><strong>const_cast</strong></li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å¸¸é‡è½¬åŒ–ä¸ºéå¸¸é‡</span>
<span class="c1">//ä¸€èˆ¬ç”¨äºä¿®æ”¹æŒ‡é’ˆ</span>
<span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span> <span class="p">};</span>
<span class="k">const</span> <span class="kt">int</span> <span class="o">*</span><span class="n">const_ptr</span> <span class="o">=</span> <span class="n">array</span><span class="p">;</span>
<span class="kt">int</span> <span class="o">*</span><span class="n">ptr</span> <span class="o">=</span> <span class="k">const_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">const_ptr</span><span class="p">);</span>

<span class="n">const_ptr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">//error</span>
<span class="n">ptr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>  <span class="c1">//pass</span>
</code></pre></div></div>

<ol>
  <li><strong>static_cast</strong></li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ä¸cä¸­çš„å¼ºåˆ¶è½¬æ¢åŸºæœ¬ä¸€è‡´ï¼Œä¸å¯¹ç±»å‹è¿›è¡Œæ£€æŸ¥ï¼Œè½¬æ¢å­˜åœ¨å®‰å…¨éšæ‚£</span>
<span class="c1">//ä¸€èˆ¬ç”¨äºåŸºç±»å’Œæ´¾ç”Ÿç±»çš„è½¬æ¢ã€åŸºç¡€ç±»å‹ä¹‹é—´çš„è½¬æ¢</span>
<span class="c1">//static_castä¸èƒ½è½¬æ¢æ‰åŸæœ‰çš„constã€volatileä¹‹ç±»çš„å±æ€§</span>
<span class="c1">//c++ä¸­çš„éšå¼è½¬æ¢å°±æ˜¯é€šè¿‡static_castå®ç°çš„</span>
<span class="kt">float</span> <span class="n">pi</span> <span class="o">=</span> <span class="mf">3.14159</span><span class="n">f</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">pi_int</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pi</span><span class="p">);</span>  <span class="c1">//pi_int = 3;</span>

<span class="k">class</span> <span class="nc">base</span> <span class="p">{};</span>
<span class="k">class</span> <span class="nc">sub</span> <span class="o">:</span> <span class="k">public</span> <span class="n">base</span> <span class="p">{};</span>

<span class="n">base</span> <span class="n">b</span><span class="p">;</span>
<span class="n">sub</span> <span class="n">s</span><span class="p">;</span>
<span class="n">base</span> <span class="o">*</span><span class="n">b_ptr</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">base</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>  <span class="c1">//pass &amp; safe</span>
<span class="n">sub</span> <span class="o">*</span><span class="n">s_ptr</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">sub</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>  <span class="c1">//pass &amp; unsafe</span>
</code></pre></div></div>

<ol>
  <li><strong>dynamic_cast</strong></li>
</ol>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å¼ºåˆ¶ç±»å‹è½¬æ¢çš„æ‰‹æ®µ</span>
<span class="c1">//åœ¨è¿è¡Œæ—¶è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œä¸èƒ½ç”¨äºåŸºç¡€ç±»å‹è½¬æ¢</span>
<span class="c1">//åŸºç±»ä¸­æ²¡æœ‰è™šå‡½æ•°ï¼Œä½¿ç”¨dynamic_castç¼–è¯‘ä¸è¿‡</span>
<span class="c1">//åœ¨ç±»çš„è½¬æ¢æ—¶ï¼Œåœ¨ç±»å±‚æ¬¡é—´è¿›è¡Œä¸Šè¡Œè½¬æ¢æ—¶ï¼Œdynamic_castå’Œstatic_castçš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</span>
<span class="c1">//åœ¨è¿›è¡Œä¸‹è¡Œè½¬æ¢ æ—¶ï¼Œdynamic_castå…·æœ‰ç±»å‹æ£€æŸ¥çš„åŠŸèƒ½ï¼Œæ¯” static_castæ›´å®‰å…¨ã€‚</span>
<span class="c1">//å‘ä¸Šè½¬æ¢å³ä¸ºæŒ‡å‘å­ç±»å¯¹è±¡çš„å‘ä¸‹è½¬æ¢ï¼Œå³å°†çˆ¶ç±»æŒ‡é’ˆè½¬åŒ–å­ç±»æŒ‡é’ˆã€‚</span>
<span class="c1">//å‘ä¸‹è½¬æ¢çš„æˆåŠŸä¸å¦è¿˜ä¸å°†è¦è½¬æ¢çš„ç±»å‹æœ‰å…³ï¼Œå³è¦è½¬æ¢çš„æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡çš„å®é™…ç±»å‹ä¸è½¬æ¢ä»¥åçš„å¯¹è±¡ç±»å‹ä¸€å®šè¦ç›¸åŒï¼Œå¦åˆ™è½¬æ¢å¤±è´¥ã€‚</span>
<span class="k">class</span> <span class="nc">base</span>
<span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">base</span><span class="p">()</span> <span class="p">{}</span>
    <span class="k">virtual</span> <span class="o">~</span><span class="n">base</span><span class="p">()</span> <span class="p">{}</span>
    <span class="kt">void</span> <span class="n">print</span><span class="p">()</span> <span class="p">{</span> <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"base print called"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">sub</span> <span class="o">:</span> <span class="k">public</span> <span class="n">base</span>
<span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">sub</span><span class="p">()</span> <span class="p">{}</span>
    <span class="o">~</span><span class="n">sub</span><span class="p">()</span> <span class="p">{}</span>

    <span class="kt">void</span> <span class="n">print</span><span class="p">()</span> <span class="p">{</span> <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"sub print called"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="n">sub</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">sub</span><span class="p">();</span>
<span class="n">s</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span> <span class="c1">//output: sub print called</span>

<span class="n">base</span> <span class="o">*</span><span class="n">b</span> <span class="o">=</span> <span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">base</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">sub</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">!=</span> <span class="nb">nullptr</span><span class="p">)</span>
    <span class="n">b</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span> <span class="c1">//output: base print called</span>

<span class="n">base</span> <span class="o">*</span><span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">base</span><span class="p">();</span>
<span class="n">b</span><span class="o">-&gt;</span><span class="n">print</span><span class="p">();</span> <span class="c1">//output: base print called</span>
<span class="n">sub</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">sub</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">base</span><span class="p">);</span>  <span class="c1">//pass but s == nullptr</span>
</code></pre></div></div>

<ol>
  <li><strong>reinterpret_cast</strong><br />
å¼ºåˆ¶ç±»å‹è½¬æ¢ç¬¦ç”¨æ¥å¤„ç†æ— å…³ç±»å‹è½¬æ¢<br />
é€šå¸¸ä¸ºæ“ä½œæ•°çš„ä½æ¨¡å¼æä¾›è¾ƒä½å±‚æ¬¡çš„é‡æ–°è§£é‡Š<br />
ä»…ä»…é‡æ–°è§£é‡Šäº†ç»™å‡ºçš„å¯¹è±¡çš„æ¯”ç‰¹æ¨¡å‹ï¼Œå¹¶æ²¡æœ‰è¿›è¡ŒäºŒè¿›åˆ¶çš„è½¬æ¢</li>
</ol>

<p>é€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
  <li>ä»æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆè½¬å‘å¦ä¸€ä¸ªä¸åŒç±»å‹çš„æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆ</li>
  <li>ä»ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆè½¬å‘å¦ä¸€ä¸ªä¸åŒç±»å‹çš„æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆ</li>
  <li>æŒ‡é’ˆè½¬å‘è¶³å¤Ÿå¤§çš„æ•´æ•°ç±»å‹</li>
  <li>ä»æ•´å½¢æˆ–è€…enumæšä¸¾ç±»å‹è½¬æ¢ä¸ºæŒ‡é’ˆ</li>
</ul>

<h3 id="c11æ–°ç‰¹æ€§">C++11æ–°ç‰¹æ€§</h3>
<h4 id="variadic-templates">Variadic Templates</h4>

<ul>
  <li>ä½¿ç”¨â€¦ä½œä¸ºæ•°é‡ä¸å®šçš„æ¨¡æ¿æ ‡è¯†ç¬¦ï¼Œå¯ä»¥ä¼ å…¥ä»»æ„ä¸ªæ•°çš„å‚æ•°ï¼Œç±»æ¯”äºcsharpä¸­çš„paramsã€‚</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ç”¨äºå¤„ç†æ— å‚æ•°çš„æƒ…å†µ</span>
<span class="kt">void</span> <span class="nf">print</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span> <span class="k">typename</span><span class="o">...</span> <span class="nc">Types</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Types</span><span class="o">&amp;</span><span class="p">...</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">obj</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">print</span><span class="p">(</span><span class="n">args</span><span class="p">...);</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>ä½¿ç”¨sizeofâ€¦(args)æ¥è®¡ç®—å‚æ•°ä¸ªæ•°</li>
  <li>ä¼˜ç‚¹ï¼šå¯ä»¥å¾ˆæ–¹ä¾¿å®Œæˆrecursive function callï¼ˆé€’å½’è°ƒç”¨ï¼‰å’Œrecursive inheritanceï¼ˆé€’å½’ç»§æ‰¿ï¼‰</li>
</ul>

<h4 id="ç¼–è¯‘å™¨ä¼˜åŒ–">Â»ç¼–è¯‘å™¨ä¼˜åŒ–</h4>
<p>åœ¨c++11ä¸‹ï¼Œ<code class="language-plaintext highlighter-rouge">vector&lt;vector&lt;int&gt;&gt; a;</code>çš„å†™æ³•å¯ä»¥è¢«æ­£ç¡®è¯†åˆ«äº†ï¼Œæ—§ç‰ˆæœ¬å†™æ³•<code class="language-plaintext highlighter-rouge">vector&lt;vector&lt;int&gt; &gt; a;</code></p>

<h4 id="nullptr--stdnullptr_t">nullptr &amp; std::nullptr_t</h4>
<ul>
  <li>c++11å…è®¸ä½¿ç”¨nullpträ»£æ›¿0æˆ–è€…NULLç”¨äºæ ‡è¯†ç©ºæŒ‡é’ˆ</li>
  <li>å¼•è¿›nullpträ¹‹åå°±å¯ä»¥å½»åº•å¼ƒç”¨NULLäº†</li>
  <li>nullptrçš„ç±»å‹æ˜¯nullptr_t</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å‡½æ•°å£°æ˜</span>
<span class="kt">void</span> <span class="nf">fun</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">fun</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">);</span>

<span class="c1">//å‡½æ•°è°ƒç”¨</span>
<span class="n">fun</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>         <span class="c1">//c++11èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«è°ƒç”¨å‡½æ•°fun(int)</span>
<span class="n">fun</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>      <span class="c1">//è°ƒç”¨å‡½æ•°fun(int)ï¼Œå› ä¸ºc++ä¸­NULLçš„å®šä¹‰ä¸º define NULL 0</span>
<span class="n">fun</span><span class="p">(</span><span class="nb">nullptr</span><span class="p">);</span>   <span class="c1">//è°ƒç”¨å‡½æ•°fun(void*)</span>

<span class="c1">//cè¯­è¨€ä¸­çš„NULLå®šä¹‰</span>
<span class="cp">#define NULL ((void*)0)
</span><span class="c1">//c++ä¸­çš„NULLå®šä¹‰</span>
<span class="cp">#define NULL 0
#else
#define NULL ((void *)0)
#endif
</span></code></pre></div></div>

<h4 id="auto-å…³é”®å­—">auto å…³é”®å­—</h4>
<ul>
  <li>With c++11, you can declare a variable or an object without specifying its specific type by using auto.</li>
  <li>Using auto is especially useful where the type is a pretty long and/or complicated expression(like lambda).</li>
  <li>auto å¿…é¡»åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±æŒ‡å®šç±»å‹</li>
</ul>

<h4 id="uniform-initialization---ä¸€è‡´æ€§åˆå§‹åŒ–">Uniform Initialization - ä¸€è‡´æ€§åˆå§‹åŒ–</h4>
<ul>
  <li>ä½¿ç”¨å¤§æ‹¬å·å¯¹å˜é‡è¿›è¡Œåˆå§‹åŒ–</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">values</span><span class="p">[]</span> <span class="p">{</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span> <span class="p">};</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">v</span> <span class="p">{</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span> <span class="p">};</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">strs</span> <span class="p">{</span> <span class="s">"one"</span><span class="p">,</span> <span class="s">"two"</span><span class="p">,</span> <span class="s">"three"</span> <span class="p">};</span>

<span class="c1">//ä»¥ä¸‹ä¸¤è¡Œä»£ç åŠŸèƒ½ç›¸ç­‰</span>
<span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">c</span> <span class="p">{</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.0</span> <span class="p">};</span>
<span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>åŸç†ï¼šå†…éƒ¨ä½¿ç”¨<code class="language-plaintext highlighter-rouge">initalizer_list&lt;T&gt;</code>å®ç°ï¼Œå…¶å…³è”è‡³ä¸€ä¸ªarray&lt;T, n&gt;ã€‚<br />
è°ƒç”¨å‡½æ•°æ—¶arrayå†…çš„å…ƒç´ å¯è¢«ç¼–è¯‘å™¨åˆ†è§£é€ä¸€ä¼ ç»™å‡½æ•°ã€‚</li>
</ul>

<h4 id="initalizer_list">initalizer_list</h4>
<p>å¯¹äºc++ä¸­çš„ä¸€è‡´æ€§åˆå§‹åŒ–è€Œè¨€ï¼Œå…¶å†…éƒ¨ä½¿ç”¨çš„initalizer_listå¯ä»¥ç”¨äºæ¥å—ä¸€ä¸ª{}åŒ…å›´çš„å€¼åˆ—è¡¨ã€‚</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">initalizer_list</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vals</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">v</span><span class="o">:</span><span class="n">vals</span><span class="p">)</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">v</span><span class="o">&lt;&lt;</span><span class="s">" "</span><span class="p">;</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//è°ƒç”¨æ–¹å¼</span>
<span class="n">print</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">});</span>
</code></pre></div></div>

<h4 id="range-based-for-statement">range-based for statement</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ä½¿ç”¨ä»¥ä¸‹è¯­æ³•å¯¹å®¹å™¨è¿›è¡Œéå†</span>
<span class="k">for</span> <span class="p">(</span><span class="n">decl</span> <span class="o">:</span> <span class="n">coll</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">statement</span>
<span class="p">}</span>

<span class="c1">//example</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">})</span> <span class="p">{</span> <span class="p">}</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">elem</span> <span class="o">:</span> <span class="n">vec</span><span class="p">)</span> <span class="p">{</span> <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">elem</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span> <span class="p">}</span>

<span class="c1">//å¯¹äºå¼•ç”¨ï¼Œéœ€è¦ä½¿ç”¨&amp;</span>
<span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span> <span class="n">elem</span> <span class="o">:</span> <span class="n">vec</span><span class="p">)</span> <span class="p">{</span> <span class="n">elem</span><span class="o">*=</span><span class="mi">3</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div></div>

<h4 id="defalut-delete">=defalut, =delete</h4>
<ul>
  <li>å¦‚æœåœ¨classä¸­å·²æœ‰ctorçš„å®šä¹‰ï¼Œç¼–è¯‘å™¨ä¸ä¼šç»™å‡ºdefault ctorï¼Œä½†æ˜¯å¦‚æœåŠ ä¸Š=defaultï¼Œå°±å¯ä»¥é‡æ–°è·å–å¹¶ä½¿ç”¨default ctorã€‚</li>
  <li>=deleteæ„å‘³ç€è¯¥å‡½æ•°å·²è¢«æŠ›å¼ƒï¼Œä¸å¯ä½¿ç”¨ï¼ˆç¼–è¯‘å™¨ä¼šæŠ¥å¼‚å¸¸â€œ[Error] use of deleted function â€˜function nameâ€™â€ï¼‰</li>
  <li>æˆå‘˜å‡½æ•°ä¸èƒ½=default</li>
</ul>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">zoo</span>
<span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">zoo</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="kt">int</span> <span class="n">j</span><span class="p">)</span> <span class="o">:</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">b</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
    <span class="n">zoo</span><span class="p">(</span><span class="k">const</span> <span class="n">zoo</span><span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>
    <span class="n">zoo</span><span class="p">(</span><span class="n">zoo</span><span class="o">&amp;&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    
    <span class="n">zoo</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">zoo</span><span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>
    <span class="n">zoo</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">zoo</span><span class="o">&amp;&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>
    
    <span class="k">virtual</span> <span class="o">~</span><span class="n">zoo</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
<span class="nl">private:</span>
    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>

<span class="p">}</span>
</code></pre></div></div>

<h4 id="using-æ–°ç”¨æ³•">using æ–°ç”¨æ³•</h4>
<ul>
  <li>Alias Template (template typedef)</li>
</ul>

<p>ä½¿ç”¨using æ¥å¯¹æ¨¡æ¿è¿›è¡ŒåŒ–åå¤„ç†ã€‚</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">using</span> <span class="n">Vec</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">MyAlloc</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">;</span>

<span class="c1">//ä½¿ç”¨Vecä»£è¡¨è¯¥æ¨¡æ¿ç±»å‹</span>
<span class="c1">//ä½¿ç”¨å®å®šä¹‰å’Œtypedefå‡æ— æ³•è¾¾åˆ°ç›¸åŒæ•ˆæœ</span>
<span class="c1">//ä½†æ˜¯Vecæ— æ³•è¢«ç‰¹åŒ–å’Œåç‰¹åŒ–</span>
<span class="n">Vec</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">;</span>
</code></pre></div></div>
<ul>
  <li>Type Alias</li>
</ul>

<p>ä½¿ç”¨usingå¯¹ç±»å‹è¿›è¡ŒåŒ–åå¤„ç†</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ä»¥ä¸‹ä»£ç ç­‰åŒ</span>
<span class="k">typedef</span> <span class="nf">void</span><span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="p">)(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="k">using</span> <span class="n">func</span> <span class="o">=</span> <span class="kt">void</span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>

<span class="c1">//è°ƒç”¨</span>
<span class="kt">void</span> <span class="nf">swap</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="n">a</span><span class="o">^=</span><span class="n">b</span><span class="o">^=</span><span class="n">a</span><span class="o">^=</span><span class="n">b</span><span class="p">;</span> <span class="p">}</span>
<span class="n">func</span> <span class="n">f</span> <span class="o">=</span> <span class="n">swap</span><span class="p">;</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">struct</span> <span class="nc">container</span>
<span class="p">{</span>
    <span class="c1">//ä»¥ä¸‹ä»£ç ç­‰åŒ</span>
    <span class="k">typedef</span> <span class="n">T</span> <span class="n">value_type</span><span class="p">;</span>
    <span class="k">using</span> <span class="n">value_type</span> <span class="o">=</span> <span class="n">T</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="decltype">decltype</h4>
<p>decltypeå…³é”®å­—ä¸typeofä½œç”¨ä¸€è‡´ã€‚</p>

<h4 id="lambdas">Lambdas</h4>
<ul>
  <li>C++11 introduced <strong>lambdas</strong>, allowing the definition of inline fuctionality, which can be used as a parameter or a local object. Lambdas change the way c++ standard library is used.</li>
  <li>A lambda is a definition of functionality that can be defined inside statements and expressions. Thus, you can use a lambda as an inline function. The minimal lambda function has no parameters and simply does something.</li>
  <li>è¯­æ³•æ ¼å¼<br />
<code class="language-plaintext highlighter-rouge">[å¤–éƒ¨å˜é‡](å‚æ•°åˆ—è¡¨)[mutableï¼ˆå¯é€‰1ï¼‰][throw_specï¼ˆå¯é€‰2ï¼‰][-&gt;return_typeï¼ˆå¯é€‰3ï¼‰]() { body }</code></li>
</ul>

<p>å½“å¯é€‰1ã€2ã€3æœ‰ä¸€ä¸ªå­˜åœ¨æ—¶ï¼Œå‚æ•°åˆ—è¡¨çš„()ä¸€å®šè¦å‡ºç°ï¼Œå³ä½¿æ²¡æœ‰å‚æ•°</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//æ— è¿”å›å€¼æ— å‚æ•°çš„lambda</span>
<span class="p">[]</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"easy lambda"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span> <span class="p">}</span>
<span class="c1">//ç›´æ¥è°ƒç”¨</span>
<span class="p">[]</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"easy lambda"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span> <span class="p">}();</span>
<span class="c1">//é—´æ¥è°ƒç”¨</span>
<span class="k">auto</span> <span class="n">f</span> <span class="o">=</span> <span class="p">[]</span> <span class="p">{</span> <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"easy lambda"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span> <span class="p">};</span>
<span class="n">f</span><span class="p">();</span>

<span class="c1">//å¸¦å¤–éƒ¨å‚æ•°çš„lambda</span>
<span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="c1">//pass by value</span>
<span class="c1">//å¦‚æœæ²¡æœ‰mutableï¼Œid++æ“ä½œæ— æ³•æ‰§è¡Œï¼ˆç¼–è¯‘å™¨æŠ¥é”™increment of read-only variable 'id'ï¼‰</span>
<span class="k">auto</span> <span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="n">id</span><span class="p">]()</span> <span class="k">mutable</span>
<span class="p">{</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"id:"</span><span class="o">&lt;&lt;</span><span class="n">id</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">id</span><span class="o">++</span><span class="p">;</span>
<span class="p">};</span>

</code></pre></div></div>
<ul>
  <li>æ›´å¤šæœ‰å…³lambdaå‡½æ•°çš„ä¿¡æ¯å‚è§æ­¤é“¾æ¥: <a href="https://docs.microsoft.com/zh-cn/cpp/cpp/lambda-expressions-in-cpp?view=msvc-160" target="_blank">C++ ä¸­çš„ Lambda è¡¨è¾¾å¼</a></li>
</ul>

<hr />

:ET