I"0<hr />
<h2 id="0x0-å¼•è¨€">0x0. å¼•è¨€</h2>
<p>å¯¹è±¡æ± æ˜¯æ¸¸æˆå¼€å‘ä¸­è€ç”Ÿå¸¸è°ˆçš„ä¸œè¥¿äº†ã€‚ä¸€ä¸ªå¥½çš„å¯¹è±¡æ± å¯¹äºæ¸¸æˆé¡¹ç›®çš„æ•´ä½“æ€§èƒ½æå‡éå¸¸å¤§ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»ä¸€ä¸ªå¼€æºæ–¹ä¾¿çš„å¯¹è±¡æ± ç³»ç»Ÿâ€”â€”MLObjectPoolã€‚<br />
MLObjectPoolæ˜¯æœ¬äººåœ¨å»å¹´å¼€å‘çš„ä¸€ä¸ªé’ˆå¯¹Unityæ¸¸æˆå¼•æ“çš„å¯¹è±¡æ± ç³»ç»Ÿï¼Œå…¶ä»¥DLLåŠ¨æ€åº“çš„å½¢å¼æŒ‚è½½åœ¨Unity Engineä¸­ã€‚<br />
æœ¬æ¨¡å—æ‰€æœ‰ä»£ç å·²ç»åœ¨githubä¸­å¼€æºï¼Œå¦‚éœ€æºä»£ç è¯·<a href="https://github.com/GhostYii/MLObjectPool" target="_blank">ç‚¹å‡»æ­¤å¤„</a>ã€‚</p>
<blockquote>
  <p>æ³¨æ„ï¼šæœªæ¥MLObjectPoolå°†ä¼šæ•´åˆè¿›MLToolBoxè¿è¡Œåº“é¡¹ç›®ä¸­ã€‚</p>
</blockquote>

<hr />
<h2 id="0x1-å¦‚ä½•ä½¿ç”¨">0x1. å¦‚ä½•ä½¿ç”¨ï¼Ÿ</h2>
<p>MLObjectPoolå·¥ç¨‹åˆ†ä¸ºä¸¤éƒ¨åˆ†â€”â€”ç¼–è¾‘å™¨æ‹“å±•ä¸è¿è¡Œæ—¶æ‰˜ç®¡åº“ï¼Œå¦‚æœ‰éœ€è¦å¯¹æºç è¿›è¡Œæ”¹é€ ï¼Œè¯·å°†ç¼–è¾‘å™¨ä»£ç å†™åœ¨MLObjectPool.Editorå·¥ç¨‹ä¸­ï¼Œå…¶ä½™ä»£ç å†™åœ¨MLObjectPoolä¸­ã€‚<br />
MLObjectPoolå·²ç»å­˜åœ¨ä¸¤ç§ç±»å‹çš„build-inå¯¹è±¡æ± :Pool&lt; T &gt;å’ŒPrefabPoolã€‚</p>

<p><strong>å¦‚éœ€åˆ›å»ºbuild-inå¯¹è±¡æ± ï¼Œè¯·ä½¿ç”¨ä¸”ä»…å¯ä½¿ç”¨å¦‚ä¸‹APIï¼š</strong></p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// åˆ›å»ºä¸€ä¸ªæ™®é€šå¯¹è±¡æ± </span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;typeparam name="T"&gt;å¯¹è±¡æ± å¯¹è±¡ç±»å‹&lt;/typeparam&gt;</span>
<span class="c1">/// &lt;param name="name"&gt;å¯¹è±¡æ± åç§°ï¼ˆä¸å¯é‡å¤ï¼‰&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="size"&gt;å¯¹è±¡æ¬¡åˆå§‹å¤§å°&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="autoExpand"&gt;æ˜¯å¦è‡ªåŠ¨æ‰©å®¹&lt;/param&gt;</span>
<span class="n">ObjectPoolManager</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">CreatePool</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">autoExpand</span><span class="p">);</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// åˆ›å»ºé¢„åˆ¶ä½“å¯¹è±¡æ± </span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="name"&gt;å¯¹è±¡æ± åç§°ï¼ˆä¸å¯é‡å¤ï¼‰&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="go"&gt;å¯¹è±¡æ± é¢„åˆ¶ä½“&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="size"&gt;å¯¹è±¡æ± å¤§å°&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="autoExpand"&gt;æ˜¯å¦è‡ªåŠ¨æ‰©å®¹&lt;/param&gt;</span>
<span class="n">ObjectPoolManager</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="nf">CreatePrefabPool</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="n">GameObject</span> <span class="n">go</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">autoExpand</span><span class="p">);</span>
</code></pre></div></div>
<p>Poolå¯¹è±¡æ± å’ŒPrefabPoolå¯¹è±¡æ± çš„åŒºåˆ«åœ¨äºPrefabPoolä¸­çš„å¯¹è±¡å·²ç»é™å®šä¸ºGameObjectï¼Œè€ŒPoolåˆ™æ˜¯ä¸€ä¸ªé€šç”¨å¯¹è±¡æ± ï¼ŒåŒæ—¶<strong>PrefabPoolä¸­åˆ†é…çš„å¯¹è±¡å°†éƒ½å¸¦æœ‰PrefabPoolObjectè„šæœ¬</strong>ã€‚</p>

<p>å‚æ•°â€™autoExpandâ€™è¡¨ç¤ºå½“æ± è¢«å¡«å……æ—¶ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨åˆ›å»ºæ›´å¤šå¯¹è±¡ï¼ˆåŸå§‹æ± çš„å¤§å°ï¼‰ä»¥ä¾›ä¸‹ä¸€æ¬¡åˆ†é…ã€‚è¿™æ„å‘³ç€<strong>å¯¹è±¡æ± æ¯æ¬¡å¡«æ»¡æ—¶éƒ½ä¼šè‡ªåŠ¨æ‰©å±•ä¸ºå½“å‰å¯¹è±¡æ± å¤§å°çš„ä¸¤å€</strong>ã€‚</p>

<p>Pool&lt; T&gt;å’ŒPrefabPooléƒ½ä¼šåœ¨åˆå§‹åŒ–æ—¶è¿›è¡Œé¢„çƒ­å¤„ç†ï¼Œå³åˆå§‹åŒ–é˜¶æ®µä¸€æ¬¡æ€§ç”Ÿæˆåˆå§‹å¤§å°çš„æ‰€æœ‰å¯¹è±¡ã€‚</p>

<p>å¯¹è±¡æ± é€šç”¨åˆ†é…å’Œå›æ”¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹APIå®ç°ï¼š</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//åˆ†é…</span>
<span class="n">ObjectPool</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="nf">AllocationFromPool</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">);</span>
<span class="c1">//å›æ”¶</span>
<span class="n">ObjectPool</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">RecycleFromPool</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="n">T</span> <span class="n">obj</span><span class="p">);</span>
</code></pre></div></div>

<hr />
<h2 id="0x2-pool-tå’Œprefabpoolå¦‚ä½•ä½¿ç”¨">0x2. Pool&lt; T&gt;å’ŒPrefabPoolå¦‚ä½•ä½¿ç”¨ï¼Ÿ</h2>
<p>Pool&lt; T&gt;æ˜¯MLObjectPoolä¸­é€šç”¨çš„å¯¹è±¡æ± ï¼Œä½†æ˜¯å…¶åˆ†é…å’Œå›æ”¶æ“ä½œéœ€è¦æ‰‹åŠ¨å®šä¹‰ã€‚å¯¹Pool&lt; T&gt;ï¼Œåˆ›å»ºã€åˆ†é…å’Œå›æ”¶è°ƒç”¨å‚è€ƒä»¥ä¸‹APIï¼š</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//create</span>
<span class="kt">var</span> <span class="n">goPool</span> <span class="p">=</span> <span class="n">ObjectPoolManager</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">CreatePool</span><span class="p">&lt;</span><span class="n">GameObject</span><span class="p">&gt;(</span><span class="s">"gameObject"</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

<span class="c1">//allocation</span>
<span class="kt">var</span> <span class="n">obj</span> <span class="p">=</span> <span class="n">goPool</span><span class="p">.</span><span class="nf">allocation</span><span class="p">();</span>

<span class="c1">//recycle</span>
<span class="n">goPool</span><span class="p">.</span><span class="nf">Recycle</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
</code></pre></div></div>

<p>PrefabPoolæ˜¯é’ˆå¯¹Prefabè€Œè¨€çš„ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡æ± ï¼Œå…¶å®šä¹‰äº†é»˜è®¤çš„åˆ†é…ä¸å›æ”¶æ“ä½œã€‚å¯¹PrefabPoolï¼Œåˆ›å»ºã€åˆ†é…å’Œå›æ”¶è°ƒç”¨å‚è€ƒä»¥ä¸‹APIï¼š</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//create</span>
<span class="kt">var</span> <span class="n">prefabPool</span> <span class="p">=</span> <span class="n">ObjectPoolManager</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="nf">CreatePrefabPool</span><span class="p">(</span><span class="s">"prefab"</span><span class="p">,</span> <span class="n">prefab</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

<span class="c1">//allocation</span>
<span class="kt">var</span> <span class="n">prefab</span> <span class="p">=</span> <span class="n">prefabPool</span><span class="p">.</span><span class="nf">Allocation</span><span class="p">();</span>

<span class="c1">//recycle</span>
<span class="n">prefabPool</span><span class="p">.</span><span class="nf">Recycle</span><span class="p">(</span><span class="n">prefab</span><span class="p">);</span>
</code></pre></div></div>

<hr />
<h2 id="0x3-å…¶ä»–åŠŸèƒ½">0x3. å…¶ä»–åŠŸèƒ½</h2>
<h3 id="å…³äºæ‹“å±•">å…³äºæ‹“å±•</h3>
<p>MLObjectPoolæä¾›äº†ä¸€ä¸ªåŸºç±»â€™<strong>PoolBase</strong>â€˜ä¾›è‡ªå®šä¹‰ç±»å‹çš„ObjectPoolç»§æ‰¿ã€‚</p>

<h3 id="å…³äºbuild-in-interface">å…³äºbuild-in interface</h3>
<p>MLObjectPoolä¸­æä¾›äº†6ä¸ªæ¥å£ä¾›pool objectè‡ªå®šä¹‰å¯¹è±¡æ± å„ä¸ªé˜¶æ®µçš„æ“ä½œï¼Œå…¶6ä¸ªæ¥å£åˆ†åˆ«ä¸ºï¼š</p>
<ul>
  <li>IAllocationHandler : åœ¨å¯¹è±¡è¢«åˆ†é…æ—¶è°ƒç”¨</li>
  <li>IRecycleHandler   : åœ¨å¯¹è±¡è¢«å›æ”¶æ—¶è°ƒç”¨</li>
  <li>IBeforeAllocationHandler  : åœ¨å¯¹è±¡è¢«åˆ†é…å‰è°ƒç”¨</li>
  <li>IBeforeRecycleHandler  : åœ¨å¯¹è±¡è¢«å›æ”¶å‰è°ƒç”¨</li>
  <li>IAfterAllocationHandler   : åœ¨å¯¹è±¡è¢«åˆ†é…åè°ƒç”¨</li>
  <li>IAfterRecycleHandler  : åœ¨å¯¹è±¡è¢«å›æ”¶åè°ƒç”¨</li>
</ul>

<p>å…¶å†…éƒ¨è°ƒç”¨é¡ºåºå¦‚ä¸‹ï¼š<br />
åœ¨åˆ†é…é˜¶æ®µï¼šOnBeforeAllocation -&gt; OnAllocation/DefaultAllocation -&gt; OnAfterAllocation<br />
åœ¨å›æ”¶é˜¶æ®µï¼šOnBeforeRecycle -&gt; OnRecycle/DefaultRecycle -&gt; OnAfterRecycle</p>

<p>æ³¨æ„ï¼š<strong>pool objectå®ç°äº†IAllocationHandleræˆ–è€…IRecycleHandleræ¥å£ï¼Œå…¶é»˜è®¤çš„åˆ†é…/å›æ”¶æ“ä½œå°†è¢«æ›¿ä»£</strong>ã€‚</p>

<h3 id="å…³äºprefabpoolçš„é»˜è®¤åˆ†é…å›æ”¶æ“ä½œ">å…³äºPrefabPoolçš„é»˜è®¤åˆ†é…/å›æ”¶æ“ä½œ</h3>
<p>å…¶é»˜è®¤åˆ†é…/å›æ”¶ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//åˆ†é…</span>
<span class="k">void</span> <span class="nf">OnGameObjectSpawn</span><span class="p">(</span><span class="n">GameObject</span> <span class="n">obj</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">obj</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="nf">SetParent</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
    <span class="n">obj</span><span class="p">.</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//å›æ”¶</span>
<span class="k">void</span> <span class="nf">OnGameObjectDespawn</span><span class="p">(</span><span class="n">GameObject</span> <span class="n">obj</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">obj</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">parent</span> <span class="p">=</span> <span class="n">poolRoot</span><span class="p">;</span>
    <span class="n">obj</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
    <span class="n">obj</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">;</span>
    <span class="n">obj</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localScale</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">one</span><span class="p">;</span>
    <span class="n">obj</span><span class="p">.</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<p>è¿™äº›æ¥å£å¯ä»¥åœ¨ä»»æ„monoè„šæœ¬ä¸­è¢«å®ç°ã€‚ä½†æ˜¯è¿™äº›æ¥å£çš„è°ƒç”¨åªèƒ½é€šè¿‡Pool&lt; T&gt;æˆ–PrefabPoolã€‚<br />
å¦‚æœæœ‰è‡ªå·±å®šä¹‰çš„Poolï¼Œéœ€è¦æ·»åŠ é¢å¤–çš„ä»£ç ä»¥æ”¯æŒè¿™äº›æ¥å£ã€‚</p>

<h3 id="å…³äºpooleventtrigger">å…³äºPoolEventTrigger</h3>
<p>PoolEventTriggeræ˜¯ä¸€ä¸ªPoolEventçš„è§¦å‘å™¨ï¼ˆä¹Ÿæ˜¯Monoè„šæœ¬ï¼‰ï¼Œç”¨æˆ·å¯ä»¥æ·»åŠ è¯¥è§¦å‘å™¨åœ¨ä»»æ„GameObjectä¸Šä»¥å®ç°PoolEventï¼ŒPoolEventå³ä¸º6ä¸ªæ¥å£æ‰€ä»£è¡¨çš„äº‹ä»¶ã€‚<br />
PoolEventTriggerçš„ä½¿ç”¨æ–¹æ³•åŒUGUIä¸­çš„EventTriggerã€‚</p>

<hr />
<h2 id="0x4-é™„å½•">0x4. é™„å½•</h2>
<p>å¦‚æœä½ éœ€è¦MLObjectPoolçš„åŠ¨æ€åº“æ–‡ä»¶ï¼Œä½ å¯ä»¥åœ¨ä¸‹æ–¹æ‰¾åˆ°ä¸‹è½½åœ°å€ï¼š</p>
<h3 id="mlobject-v105">MLObject v1.0.5</h3>
<p><a href="https://github.com/GhostYii/MLObjectPool/releases/download/v1.0.5/MLObjectPool.dll">MLObjectPool.dll</a><br />
<a href="https://github.com/GhostYii/MLObjectPool/releases/download/v1.0.5/MLObjectPool.Editor.dll">MLObjectPool.Editor.dll</a></p>

<h3 id="mlobject-v1041">MLObject v1.0.4.1</h3>
<p><a href="https://github.com/GhostYii/MLObjectPool/releases/download/v1.0.4.1/MLObjectPool.dll">MLObjectPool.dll</a><br />
<a href="https://github.com/GhostYii/MLObjectPool/releases/download/v1.0.4.1/MLObjectPool.Editor.dll">MLObjectPool.Editor.dll</a></p>

<hr />

:ET